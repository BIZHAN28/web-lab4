{"ast":null,"code":"/*\n    Copyright 2008-2023\n        Matthias Ehmann,\n        Michael Gerhaeuser,\n        Carsten Miller,\n        Bianca Valentin,\n        Alfred Wassermann,\n        Peter Wilfahrt\n\n    This file is part of JSXGraph.\n\n    JSXGraph is free software dual licensed under the GNU LGPL or MIT License.\n\n    You can redistribute it and/or modify it under the terms of the\n\n      * GNU Lesser General Public License as published by\n        the Free Software Foundation, either version 3 of the License, or\n        (at your option) any later version\n      OR\n      * MIT License: https://github.com/jsxgraph/jsxgraph/blob/master/LICENSE.MIT\n\n    JSXGraph is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License and\n    the MIT License along with JSXGraph. If not, see <https://www.gnu.org/licenses/>\n    and <https://opensource.org/licenses/MIT/>.\n */\n\n/*global JXG: true, define: true, window: true*/\n/*jslint nomen: true, plusplus: true*/\n\n/**\n * @fileoverview In this file the Text element is defined.\n */\n\nimport JXG from \"../jxg\";\nimport Const from \"./constants\";\nimport GeometryElement from \"./element\";\nimport GeonextParser from \"../parser/geonext\";\nimport Env from \"../utils/env\";\nimport Type from \"../utils/type\";\nimport Mat from \"../math/math\";\nimport CoordsElement from \"./coordselement\";\nvar priv = {\n  /**\n   * @class\n   * @ignore\n   */\n  HTMLSliderInputEventHandler: function () {\n    this._val = parseFloat(this.rendNodeRange.value);\n    this.rendNodeOut.value = this.rendNodeRange.value;\n    this.board.update();\n  }\n};\n\n/**\n * Construct and handle texts.\n *\n * The coordinates can be relative to the coordinates of an element\n * given in {@link JXG.Options#text.anchor}.\n *\n * MathJax, HTML and GEONExT syntax can be handled.\n * @class Creates a new text object. Do not use this constructor to create a text. Use {@link JXG.Board#create} with\n * type {@link Text} instead.\n * @augments JXG.GeometryElement\n * @augments JXG.CoordsElement\n * @param {string|JXG.Board} board The board the new text is drawn on.\n * @param {Array} coordinates An array with the user coordinates of the text.\n * @param {Object} attributes An object containing visual properties and optional a name and a id.\n * @param {string|function} content A string or a function returning a string.\n *\n */\nJXG.Text = function (board, coords, attributes, content) {\n  var tmp;\n  this.constructor(board, attributes, Const.OBJECT_TYPE_TEXT, Const.OBJECT_CLASS_TEXT);\n  this.element = this.board.select(attributes.anchor);\n  this.coordsConstructor(coords, Type.evaluate(this.visProp.islabel));\n  this.content = \"\";\n  this.plaintext = \"\";\n  this.plaintextOld = null;\n  this.orgText = \"\";\n  this.needsSizeUpdate = false;\n  // Only used by infobox anymore\n  this.hiddenByParent = false;\n\n  /**\n   * Width and height of the text element in pixel.\n   *\n   * @private\n   * @type Array\n   */\n  this.size = [1.0, 1.0];\n  this.id = this.board.setId(this, \"T\");\n  this.board.renderer.drawText(this);\n  this.board.finalizeAdding(this);\n\n  // Set text before drawing\n  // this._createFctUpdateText(content);\n  // this.updateText();\n\n  // Set attribute visible to true. This is necessary to\n  // create all sub-elements for button, input and checkbox\n  tmp = this.visProp.visible;\n  this.visProp.visible = true;\n  this.setText(content);\n  // Restore the correct attribute visible.\n  this.visProp.visible = tmp;\n  if (Type.isString(this.content)) {\n    this.notifyParents(this.content);\n  }\n  this.elType = \"text\";\n  this.methodMap = Type.deepCopy(this.methodMap, {\n    setText: \"setTextJessieCode\"\n    // free: 'free',\n    // move: \"setCoords\"\n  });\n};\nJXG.Text.prototype = new GeometryElement();\nType.copyPrototypeMethods(JXG.Text, CoordsElement, \"coordsConstructor\");\nJXG.extend(JXG.Text.prototype, /** @lends JXG.Text.prototype */{\n  /**\n   * @private\n   * @param {Number} x\n   * @param {Number} y\n   * @returns {Boolean}\n  */\n  // Test if the screen coordinates (x,y) are in a small stripe\n  // at the left side or at the right side of the text.\n  // Sensitivity is set in this.board.options.precision.hasPoint.\n  // If dragarea is set to 'all' (default), tests if the screen\n  // coordinates (x,y) are in within the text boundary.\n  hasPoint: function (x, y) {\n    var lft, rt, top, bot, ax, ay, type, r;\n    if (Type.isObject(Type.evaluate(this.visProp.precision))) {\n      type = this.board._inputDevice;\n      r = Type.evaluate(this.visProp.precision[type]);\n    } else {\n      // 'inherit'\n      r = this.board.options.precision.hasPoint;\n    }\n    if (this.transformations.length > 0) {\n      //Transform the mouse/touch coordinates\n      // back to the original position of the text.\n      lft = Mat.matVecMult(Mat.inverse(this.board.renderer.joinTransforms(this, this.transformations)), [1, x, y]);\n      x = lft[1];\n      y = lft[2];\n    }\n    ax = this.getAnchorX();\n    if (ax === \"right\") {\n      lft = this.coords.scrCoords[1] - this.size[0];\n    } else if (ax === \"middle\") {\n      lft = this.coords.scrCoords[1] - 0.5 * this.size[0];\n    } else {\n      lft = this.coords.scrCoords[1];\n    }\n    rt = lft + this.size[0];\n    ay = this.getAnchorY();\n    if (ay === \"top\") {\n      bot = this.coords.scrCoords[2] + this.size[1];\n    } else if (ay === \"middle\") {\n      bot = this.coords.scrCoords[2] + 0.5 * this.size[1];\n    } else {\n      bot = this.coords.scrCoords[2];\n    }\n    top = bot - this.size[1];\n    if (Type.evaluate(this.visProp.dragarea) === \"all\") {\n      return x >= lft - r && x < rt + r && y >= top - r && y <= bot + r;\n    }\n    // e.g. 'small'\n    return y >= top - r && y <= bot + r && (x >= lft - r && x <= lft + 2 * r || x >= rt - 2 * r && x <= rt + r);\n  },\n  /**\n   * This sets the updateText function of this element depending on the type of text content passed.\n   * Used by {@link JXG.Text#_setText}.\n   * @param {String|Function|Number} text\n   * @private\n   * @see JXG.Text#_setText\n   */\n  _createFctUpdateText: function (text) {\n    var updateText,\n      e,\n      digits,\n      resolvedText,\n      i,\n      that,\n      ev_p = Type.evaluate(this.visProp.parse),\n      ev_um = Type.evaluate(this.visProp.usemathjax),\n      ev_uk = Type.evaluate(this.visProp.usekatex),\n      convertJessieCode = false;\n    this.orgText = text;\n    if (Type.isFunction(text)) {\n      /**\n       * Dynamically created function to update the content\n       * of a text. Can not be overwritten.\n       * <p>\n       * &lt;value&gt; tags will not be evaluated if text is provided by a function\n       * <p>\n       * Sets the property <tt>plaintext</tt> of the text element.\n       *\n       * @private\n       */\n      this.updateText = function () {\n        resolvedText = text().toString(); // Evaluate function\n        if (ev_p && !ev_um && !ev_uk) {\n          this.plaintext = this.replaceSub(this.replaceSup(this.convertGeonextAndSketchometry2CSS(resolvedText, false)));\n        } else {\n          this.plaintext = resolvedText;\n        }\n      };\n    } else {\n      if (Type.isNumber(text)) {\n        digits = Type.evaluate(this.visProp.digits);\n        if (this.useLocale()) {\n          this.content = this.formatNumberLocale(text, digits);\n        } else {\n          this.content = Type.toFixed(text, digits);\n        }\n      } else if (Type.isString(text) && ev_p) {\n        if (Type.evaluate(this.visProp.useasciimathml)) {\n          // ASCIIMathML\n          // value-tags are not supported\n          this.content = \"'`\" + text + \"`'\";\n        } else if (ev_um || ev_uk) {\n          // MathJax or KaTeX\n          // Replace value-tags by functions\n          // sketchofont is ignored\n          this.content = this.valueTagToJessieCode(text);\n          if (!Type.isArray(this.content)) {\n            // For some reason we don't have to mask backslashes in an array of strings\n            // anymore.\n            //\n            // for (i = 0; i < this.content.length; i++) {\n            //     this.content[i] = this.content[i].replace(/\\\\/g, \"\\\\\\\\\"); // Replace single backslash by double\n            // }\n            // } else {\n            this.content = this.content.replace(/\\\\/g, \"\\\\\\\\\"); // Replace single backslash by double\n          }\n        } else {\n          // No TeX involved.\n          // Converts GEONExT syntax into JavaScript string\n          // Short math is allowed\n          // Replace value-tags by functions\n          // Avoid geonext2JS calls\n          this.content = this.poorMansTeX(this.valueTagToJessieCode(text));\n        }\n        convertJessieCode = true;\n      } else {\n        this.content = text;\n      }\n\n      // Generate function which returns the text to be displayed\n      if (convertJessieCode) {\n        // Convert JessieCode to JS function\n        if (Type.isArray(this.content)) {\n          // This is the case if the text contained value-tags.\n          // These value-tags consist of JessieCode snippets\n          // which are now replaced by JavaScript functions\n          that = this;\n          for (i = 0; i < this.content.length; i++) {\n            if (this.content[i][0] !== '\"') {\n              this.content[i] = this.board.jc.snippet(this.content[i], true, \"\", false);\n              for (e in this.content[i].deps) {\n                this.addParents(this.content[i].deps[e]);\n                this.content[i].deps[e].addChild(this);\n              }\n            }\n          }\n          updateText = function () {\n            var i,\n              t,\n              digits = Type.evaluate(that.visProp.digits),\n              txt = '';\n            for (i = 0; i < that.content.length; i++) {\n              if (Type.isFunction(that.content[i])) {\n                t = that.content[i]();\n                if (that.useLocale()) {\n                  t = that.formatNumberLocale(t, digits);\n                } else {\n                  t = Type.toFixed(t, digits);\n                }\n              } else {\n                t = that.content[i];\n                if (t.at(0) === '\"' && t.at(-1) === '\"') {\n                  t = t.slice(1, -1);\n                }\n              }\n              txt += t;\n            }\n            return txt;\n          };\n        } else {\n          updateText = this.board.jc.snippet(this.content, true, \"\", false);\n          for (e in updateText.deps) {\n            this.addParents(updateText.deps[e]);\n            updateText.deps[e].addChild(this);\n          }\n        }\n\n        // Ticks have been escaped in valueTagToJessieCode\n        this.updateText = function () {\n          this.plaintext = this.unescapeTicks(updateText());\n        };\n      } else {\n        this.updateText = function () {\n          this.plaintext = this.content; // text;\n        };\n      }\n    }\n  },\n  /**\n   * Defines new content. This is used by {@link JXG.Text#setTextJessieCode} and {@link JXG.Text#setText}. This is required because\n   * JessieCode needs to filter all Texts inserted into the DOM and thus has to replace setText by setTextJessieCode.\n   * @param {String|Function|Number} text\n   * @returns {JXG.Text}\n   * @private\n   */\n  _setText: function (text) {\n    this._createFctUpdateText(text);\n\n    // First evaluation of the string.\n    // We need this for display='internal' and Canvas\n    this.updateText();\n    this.fullUpdate();\n\n    // We do not call updateSize for the infobox to speed up rendering\n    if (!this.board.infobox || this.id !== this.board.infobox.id) {\n      this.updateSize(); // updateSize() is called at least once.\n    }\n\n    // This may slow down canvas renderer\n    // if (this.board.renderer.type === 'canvas') {\n    //     this.board.fullUpdate();\n    // }\n\n    return this;\n  },\n  /**\n   * Defines new content but converts &lt; and &gt; to HTML entities before updating the DOM.\n   * @param {String|function} text\n   */\n  setTextJessieCode: function (text) {\n    var s;\n    this.visProp.castext = text;\n    if (Type.isFunction(text)) {\n      s = function () {\n        return Type.sanitizeHTML(text());\n      };\n    } else {\n      if (Type.isNumber(text)) {\n        s = text;\n      } else {\n        s = Type.sanitizeHTML(text);\n      }\n    }\n    return this._setText(s);\n  },\n  /**\n   * Defines new content.\n   * @param {String|function} text\n   * @returns {JXG.Text} Reference to the text object.\n   */\n  setText: function (text) {\n    return this._setText(text);\n  },\n  /**\n   * Recompute the width and the height of the text box.\n   * Updates the array {@link JXG.Text#size} with pixel values.\n   * The result may differ from browser to browser\n   * by some pixels.\n   * In canvas an old IEs we use a very crude estimation of the dimensions of\n   * the textbox.\n   * JSXGraph needs {@link JXG.Text#size} for applying rotations in IE and\n   * for aligning text.\n   *\n   * @return {this} [description]\n   */\n  updateSize: function () {\n    var tmp,\n      that,\n      node,\n      ev_d = Type.evaluate(this.visProp.display);\n    if (!Env.isBrowser || this.board.renderer.type === \"no\") {\n      return this;\n    }\n    node = this.rendNode;\n\n    /**\n     * offsetWidth and offsetHeight seem to be supported for internal vml elements by IE10+ in IE8 mode.\n     */\n    if (ev_d === \"html\" || this.board.renderer.type === \"vml\") {\n      if (Type.exists(node.offsetWidth)) {\n        that = this;\n        window.setTimeout(function () {\n          that.size = [node.offsetWidth, node.offsetHeight];\n          that.needsUpdate = true;\n          that.updateRenderer();\n        }, 0);\n        // In case, there is non-zero padding or borders\n        // the following approach does not longer work.\n        // s = [node.offsetWidth, node.offsetHeight];\n        // if (s[0] === 0 && s[1] === 0) { // Some browsers need some time to set offsetWidth and offsetHeight\n        //     that = this;\n        //     window.setTimeout(function () {\n        //         that.size = [node.offsetWidth, node.offsetHeight];\n        //         that.needsUpdate = true;\n        //         that.updateRenderer();\n        //     }, 0);\n        // } else {\n        //     this.size = s;\n        // }\n      } else {\n        this.size = this.crudeSizeEstimate();\n      }\n    } else if (ev_d === \"internal\") {\n      if (this.board.renderer.type === \"svg\") {\n        that = this;\n        window.setTimeout(function () {\n          try {\n            tmp = node.getBBox();\n            that.size = [tmp.width, tmp.height];\n            that.needsUpdate = true;\n            that.updateRenderer();\n          } catch (e) {}\n        }, 0);\n      } else if (this.board.renderer.type === \"canvas\") {\n        this.size = this.crudeSizeEstimate();\n      }\n    }\n    return this;\n  },\n  /**\n   * A very crude estimation of the dimensions of the textbox in case nothing else is available.\n   * @returns {Array}\n   */\n  crudeSizeEstimate: function () {\n    var ev_fs = parseFloat(Type.evaluate(this.visProp.fontsize));\n    return [ev_fs * this.plaintext.length * 0.45, ev_fs * 0.9];\n  },\n  /**\n   * Decode unicode entities into characters.\n   * @param {String} string\n   * @returns {String}\n   */\n  utf8_decode: function (string) {\n    return string.replace(/&#x(\\w+);/g, function (m, p1) {\n      return String.fromCharCode(parseInt(p1, 16));\n    });\n  },\n  /**\n   * Replace _{} by &lt;sub&gt;\n   * @param {String} te String containing _{}.\n   * @returns {String} Given string with _{} replaced by &lt;sub&gt;.\n   */\n  replaceSub: function (te) {\n    if (!te.indexOf) {\n      return te;\n    }\n    var j,\n      i = te.indexOf(\"_{\");\n\n    // The regexp in here are not used for filtering but to provide some kind of sugar for label creation,\n    // i.e. replacing _{...} with <sub>...</sub>. What is passed would get out anyway.\n    /*jslint regexp: true*/\n    while (i >= 0) {\n      te = te.slice(0, i) + te.slice(i).replace(/_\\{/, \"<sub>\");\n      j = te.indexOf(\"}\", i + 4);\n      if (j >= 0) {\n        te = te.slice(0, j) + te.slice(j).replace(/\\}/, \"</sub>\");\n      }\n      i = te.indexOf(\"_{\");\n    }\n    i = te.indexOf(\"_\");\n    while (i >= 0) {\n      te = te.slice(0, i) + te.slice(i).replace(/_(.?)/, \"<sub>$1</sub>\");\n      i = te.indexOf(\"_\");\n    }\n    return te;\n  },\n  /**\n   * Replace ^{} by &lt;sup&gt;\n   * @param {String} te String containing ^{}.\n   * @returns {String} Given string with ^{} replaced by &lt;sup&gt;.\n   */\n  replaceSup: function (te) {\n    if (!te.indexOf) {\n      return te;\n    }\n    var j,\n      i = te.indexOf(\"^{\");\n\n    // The regexp in here are not used for filtering but to provide some kind of sugar for label creation,\n    // i.e. replacing ^{...} with <sup>...</sup>. What is passed would get out anyway.\n    /*jslint regexp: true*/\n    while (i >= 0) {\n      te = te.slice(0, i) + te.slice(i).replace(/\\^\\{/, \"<sup>\");\n      j = te.indexOf(\"}\", i + 4);\n      if (j >= 0) {\n        te = te.slice(0, j) + te.slice(j).replace(/\\}/, \"</sup>\");\n      }\n      i = te.indexOf(\"^{\");\n    }\n    i = te.indexOf(\"^\");\n    while (i >= 0) {\n      te = te.slice(0, i) + te.slice(i).replace(/\\^(.?)/, \"<sup>$1</sup>\");\n      i = te.indexOf(\"^\");\n    }\n    return te;\n  },\n  /**\n   * Return the width of the text element.\n   * @returns {Array} [width, height] in pixel\n   */\n  getSize: function () {\n    return this.size;\n  },\n  /**\n   * Move the text to new coordinates.\n   * @param {number} x\n   * @param {number} y\n   * @returns {object} reference to the text object.\n   */\n  setCoords: function (x, y) {\n    var coordsAnchor, dx, dy;\n    if (Type.isArray(x) && x.length > 1) {\n      y = x[1];\n      x = x[0];\n    }\n    if (Type.evaluate(this.visProp.islabel) && Type.exists(this.element)) {\n      coordsAnchor = this.element.getLabelAnchor();\n      dx = (x - coordsAnchor.usrCoords[1]) * this.board.unitX;\n      dy = -(y - coordsAnchor.usrCoords[2]) * this.board.unitY;\n      this.relativeCoords.setCoordinates(Const.COORDS_BY_SCREEN, [dx, dy]);\n    } else {\n      /*\n      this.X = function () {\n          return x;\n      };\n       this.Y = function () {\n          return y;\n      };\n      */\n      this.coords.setCoordinates(Const.COORDS_BY_USER, [x, y]);\n    }\n\n    // this should be a local update, otherwise there might be problems\n    // with the tick update routine resulting in orphaned tick labels\n    this.fullUpdate();\n    return this;\n  },\n  /**\n   * Evaluates the text.\n   * Then, the update function of the renderer\n   * is called.\n   */\n  update: function (fromParent) {\n    if (!this.needsUpdate) {\n      return this;\n    }\n    this.updateCoords(fromParent);\n    this.updateText();\n    if (Type.evaluate(this.visProp.display) === \"internal\") {\n      if (Type.isString(this.plaintext)) {\n        this.plaintext = this.utf8_decode(this.plaintext);\n      }\n    }\n    this.checkForSizeUpdate();\n    if (this.needsSizeUpdate) {\n      this.updateSize();\n    }\n    return this;\n  },\n  /**\n   * Used to save updateSize() calls.\n   * Called in JXG.Text.update\n   * That means this.update() has been called.\n   * More tests are in JXG.Renderer.updateTextStyle. The latter tests\n   * are one update off. But this should pose not too many problems, since\n   * it affects fontSize and cssClass changes.\n   *\n   * @private\n   */\n  checkForSizeUpdate: function () {\n    if (this.board.infobox && this.id === this.board.infobox.id) {\n      this.needsSizeUpdate = false;\n    } else {\n      // For some magic reason it is more efficient on the iPad to\n      // call updateSize() for EVERY text element EVERY time.\n      this.needsSizeUpdate = this.plaintextOld !== this.plaintext;\n      if (this.needsSizeUpdate) {\n        this.plaintextOld = this.plaintext;\n      }\n    }\n  },\n  /**\n   * The update function of the renderer\n   * is called.\n   * @private\n   */\n  updateRenderer: function () {\n    if (\n    //this.board.updateQuality === this.board.BOARD_QUALITY_HIGH &&\n    Type.evaluate(this.visProp.autoposition)) {\n      this.setAutoPosition().updateConstraint();\n    }\n    return this.updateRendererGeneric(\"updateText\");\n  },\n  /**\n   * Converts shortened math syntax into correct syntax:  3x instead of 3*x or\n   * (a+b)(3+1) instead of (a+b)*(3+1).\n   *\n   * @private\n   * @param{String} expr Math term\n   * @returns {string} expanded String\n   */\n  expandShortMath: function (expr) {\n    var re = /([)0-9.])\\s*([(a-zA-Z_])/g;\n    return expr.replace(re, \"$1*$2\");\n  },\n  /**\n   * Converts the GEONExT syntax of the <value> terms into JavaScript.\n   * Also, all Objects whose name appears in the term are searched and\n   * the text is added as child to these objects.\n   * This method is called if the attribute parse==true is set.\n   *\n   * Obsolete, replaced by JXG.Text.valueTagToJessieCode\n   *\n   * @param{String} contentStr String to be parsed\n   * @param{Boolean} [expand] Optional flag if shortened math syntax is allowed (e.g. 3x instead of 3*x).\n   * @param{Boolean} [avoidGeonext2JS] Optional flag if geonext2JS should be called. For backwards compatibility\n   * this has to be set explicitly to true.\n   * @param{Boolean} [outputTeX] Optional flag which has to be true if the resulting term will be sent to MathJax or KaTeX.\n   * If true, \"_\" and \"^\" are NOT replaced by HTML tags sub and sup. Default: false, i.e. the replacement is done.\n   * This flag allows the combination of &lt;value&gt; tag containing calculations with TeX output.\n   *\n   * @deprecated\n   * @private\n   * @see JXG.GeonextParser#geonext2JS\n   * @see JXG.Text#valueTagToJessieCode\n   *\n   */\n  generateTerm: function (contentStr, expand, avoidGeonext2JS) {\n    var res,\n      term,\n      i,\n      j,\n      plaintext = '\"\"';\n\n    // Revert possible jc replacement\n    contentStr = contentStr || \"\";\n    contentStr = contentStr.replace(/\\r/g, \"\");\n    contentStr = contentStr.replace(/\\n/g, \"\");\n    contentStr = contentStr.replace(/\"/g, \"'\");\n    contentStr = contentStr.replace(/'/g, \"\\\\'\");\n\n    // Old GEONExT syntax, not (yet) supported as TeX output.\n    // Otherwise, the else clause should be used.\n    // That means, i.e. the <arc> tag and <sqrt> tag are not\n    // converted into TeX syntax.\n    contentStr = contentStr.replace(/&amp;arc;/g, \"&ang;\");\n    contentStr = contentStr.replace(/<arc\\s*\\/>/g, \"&ang;\");\n    contentStr = contentStr.replace(/&lt;arc\\s*\\/&gt;/g, \"&ang;\");\n    contentStr = contentStr.replace(/&lt;sqrt\\s*\\/&gt;/g, \"&radic;\");\n    contentStr = contentStr.replace(/&lt;value&gt;/g, \"<value>\");\n    contentStr = contentStr.replace(/&lt;\\/value&gt;/g, \"</value>\");\n\n    // Convert GEONExT syntax into  JavaScript syntax\n    i = contentStr.indexOf(\"<value>\");\n    j = contentStr.indexOf(\"</value>\");\n    if (i >= 0) {\n      while (i >= 0) {\n        plaintext += ' + \"' + this.replaceSub(this.replaceSup(contentStr.slice(0, i))) + '\"';\n        // plaintext += ' + \"' + this.replaceSub(contentStr.slice(0, i)) + '\"';\n\n        term = contentStr.slice(i + 7, j);\n        term = term.replace(/\\s+/g, \"\"); // Remove all whitespace\n        if (expand === true) {\n          term = this.expandShortMath(term);\n        }\n        if (avoidGeonext2JS) {\n          res = term;\n        } else {\n          res = GeonextParser.geonext2JS(term, this.board);\n        }\n        res = res.replace(/\\\\\"/g, \"'\");\n        res = res.replace(/\\\\'/g, \"'\");\n\n        // GEONExT-Hack: apply rounding once only.\n        if (res.indexOf(\"toFixed\") < 0) {\n          // output of a value tag\n          if (Type.isNumber(Type.bind(this.board.jc.snippet(res, true, '', false), this)())) {\n            // may also be a string\n            plaintext += '+(' + res + ').toFixed(' + Type.evaluate(this.visProp.digits) + ')';\n          } else {\n            plaintext += '+(' + res + ')';\n          }\n        } else {\n          plaintext += '+(' + res + ')';\n        }\n        contentStr = contentStr.slice(j + 8);\n        i = contentStr.indexOf(\"<value>\");\n        j = contentStr.indexOf(\"</value>\");\n      }\n    }\n    plaintext += ' + \"' + this.replaceSub(this.replaceSup(contentStr)) + '\"';\n    plaintext = this.convertGeonextAndSketchometry2CSS(plaintext);\n\n    // This should replace e.g. &amp;pi; by &pi;\n    plaintext = plaintext.replace(/&amp;/g, \"&\");\n    plaintext = plaintext.replace(/\"/g, \"'\");\n    return plaintext;\n  },\n  /**\n   * Replace value-tags in string by JessieCode functions.\n   * @param {String} contentStr\n   * @returns String\n   * @private\n   * @example\n   * \"The x-coordinate of A is &lt;value&gt;X(A)&lt;/value&gt;\"\n   *\n   */\n  valueTagToJessieCode: function (contentStr) {\n    var res,\n      term,\n      i,\n      j,\n      expandShortMath = true,\n      textComps = [],\n      tick = '\"';\n    contentStr = contentStr || \"\";\n    contentStr = contentStr.replace(/\\r/g, \"\");\n    contentStr = contentStr.replace(/\\n/g, \"\");\n    contentStr = contentStr.replace(/&lt;value&gt;/g, \"<value>\");\n    contentStr = contentStr.replace(/&lt;\\/value&gt;/g, \"</value>\");\n\n    // Convert content of value tag (GEONExT/JessieCode) syntax into JavaScript syntax\n    i = contentStr.indexOf(\"<value>\");\n    j = contentStr.indexOf(\"</value>\");\n    if (i >= 0) {\n      while (i >= 0) {\n        // Add string fragment before <value> tag\n        textComps.push(tick + this.escapeTicks(contentStr.slice(0, i)) + tick);\n        term = contentStr.slice(i + 7, j);\n        term = term.replace(/\\s+/g, \"\"); // Remove all whitespace\n        if (expandShortMath === true) {\n          term = this.expandShortMath(term);\n        }\n        res = term;\n        res = res.replace(/\\\\\"/g, \"'\").replace(/\\\\'/g, \"'\");\n\n        // // Hack: apply rounding once only.\n        // if (res.indexOf(\"toFixed\") < 0) {\n        //     // Output of a value tag\n        //     // Run the JessieCode parser\n        //     if (\n        //         Type.isNumber(\n        //             Type.bind(this.board.jc.snippet(res, true, \"\", false), this)()\n        //         )\n        //     ) {\n        //         // Output is number\n        //         // textComps.push(\n        //         //     '(' + res + ').toFixed(' + Type.evaluate(this.visProp.digits) + ')'\n        //         // );\n        //         textComps.push('(' + res + ')');\n        //     } else {\n        //         // Output is a string\n        //         textComps.push(\"(\" + res + \")\");\n        //     }\n        // } else {\n        textComps.push(\"(\" + res + \")\");\n        // }\n        contentStr = contentStr.slice(j + 8);\n        i = contentStr.indexOf(\"<value>\");\n        j = contentStr.indexOf(\"</value>\");\n      }\n    }\n    // Add trailing string fragment\n    textComps.push(tick + this.escapeTicks(contentStr) + tick);\n\n    // return textComps.join(\" + \").replace(/&amp;/g, \"&\");\n    for (i = 0; i < textComps.length; i++) {\n      textComps[i] = textComps[i].replace(/&amp;/g, \"&\");\n    }\n    return textComps;\n  },\n  /**\n   * Simple math rendering using HTML / CSS only. In case of array,\n   * handle each entry separately and return array with the\n   * rendering strings.\n   *\n   * @param {String|Array} s\n   * @returns {String|Array}\n   * @see JXG.Text#convertGeonextAndSketchometry2CSS\n   * @private\n   * @see JXG.Text#replaceSub\n   * @see JXG.Text#replaceSup\n   * @see JXG.Text#convertGeonextAndSketchometry2CSS\n   */\n  poorMansTeX: function (s) {\n    var i, a;\n    if (Type.isArray(s)) {\n      a = [];\n      for (i = 0; i < s.length; i++) {\n        a.push(this.poorMansTeX(s[i]));\n      }\n      return a;\n    }\n    s = s.replace(/<arc\\s*\\/*>/g, \"&ang;\").replace(/&lt;arc\\s*\\/*&gt;/g, \"&ang;\").replace(/<sqrt\\s*\\/*>/g, \"&radic;\").replace(/&lt;sqrt\\s*\\/*&gt;/g, \"&radic;\");\n    return this.convertGeonextAndSketchometry2CSS(this.replaceSub(this.replaceSup(s)), true);\n  },\n  /**\n   * Replace ticks by URI escape sequences\n   *\n   * @param {String} s\n   * @returns String\n   * @private\n   *\n   */\n  escapeTicks: function (s) {\n    return s.replace(/\"/g, \"%22\").replace(/'/g, \"%27\");\n  },\n  /**\n   * Replace escape sequences for ticks by ticks\n   *\n   * @param {String} s\n   * @returns String\n   * @private\n   */\n  unescapeTicks: function (s) {\n    return s.replace(/%22/g, '\"').replace(/%27/g, \"'\");\n  },\n  /**\n   * Converts the GEONExT tags <overline> and <arrow> to\n   * HTML span tags with proper CSS formatting.\n   * @private\n   * @see JXG.Text.poorMansTeX\n   * @see JXG.Text._setText\n   */\n  convertGeonext2CSS: function (s) {\n    if (Type.isString(s)) {\n      s = s.replace(/(<|&lt;)overline(>|&gt;)/g, \"<span style=text-decoration:overline;>\");\n      s = s.replace(/(<|&lt;)\\/overline(>|&gt;)/g, \"</span>\");\n      s = s.replace(/(<|&lt;)arrow(>|&gt;)/g, \"<span style=text-decoration:overline;>\");\n      s = s.replace(/(<|&lt;)\\/arrow(>|&gt;)/g, \"</span>\");\n    }\n    return s;\n  },\n  /**\n   * Converts the sketchometry tag <sketchofont> to\n   * HTML span tags with proper CSS formatting.\n   *\n   * @param {String|Function|Number} s Text\n   * @param {Boolean} escape Flag if ticks should be escaped. Escaping is necessary\n   * if s is a text. It has to be avoided if s is a function returning text.\n   * @private\n   * @see JXG.Text._setText\n   * @see JXG.Text.convertGeonextAndSketchometry2CSS\n   *\n   */\n  convertSketchometry2CSS: function (s, escape) {\n    var t1 = \"<span class=\\\"sketcho sketcho-inherit sketcho-\",\n      t2 = \"\\\"></span>\";\n    if (Type.isString(s)) {\n      if (escape) {\n        t1 = this.escapeTicks(t1);\n        t2 = this.escapeTicks(t2);\n      }\n      s = s.replace(/(<|&lt;)sketchofont(>|&gt;)/g, t1);\n      s = s.replace(/(<|&lt;)\\/sketchofont(>|&gt;)/g, t2);\n    }\n    return s;\n  },\n  /**\n   * Alias for convertGeonext2CSS and convertSketchometry2CSS\n   *\n   * @param {String|Function|Number} s Text\n   * @param {Boolean} escape Flag if ticks should be escaped\n   * @private\n   * @see JXG.Text.convertGeonext2CSS\n   * @see JXG.Text.convertSketchometry2CSS\n   */\n  convertGeonextAndSketchometry2CSS: function (s, escape) {\n    s = this.convertGeonext2CSS(s);\n    s = this.convertSketchometry2CSS(s, escape);\n    return s;\n  },\n  /**\n   * Finds dependencies in a given term and notifies the parents by adding the\n   * dependent object to the found objects child elements.\n   * @param {String} content String containing dependencies for the given object.\n   * @private\n   */\n  notifyParents: function (content) {\n    var search,\n      res = null;\n\n    // revert possible jc replacement\n    content = content.replace(/&lt;value&gt;/g, \"<value>\");\n    content = content.replace(/&lt;\\/value&gt;/g, \"</value>\");\n    do {\n      search = /<value>([\\w\\s*/^\\-+()[\\],<>=!]+)<\\/value>/;\n      res = search.exec(content);\n      if (res !== null) {\n        GeonextParser.findDependencies(this, res[1], this.board);\n        content = content.slice(res.index);\n        content = content.replace(search, \"\");\n      }\n    } while (res !== null);\n    return this;\n  },\n  // documented in element.js\n  getParents: function () {\n    var p;\n    if (this.relativeCoords !== undefined) {\n      // Texts with anchor elements, excluding labels\n      p = [this.relativeCoords.usrCoords[1], this.relativeCoords.usrCoords[2], this.orgText];\n    } else {\n      // Other texts\n      p = [this.Z(), this.X(), this.Y(), this.orgText];\n    }\n    if (this.parents.length !== 0) {\n      p = this.parents;\n    }\n    return p;\n  },\n  /**\n   * Returns the bounding box of the text element in user coordinates as an\n   * array of length 4: [upper left x, upper left y, lower right x, lower right y].\n   * The method assumes that the lower left corner is at position [el.X(), el.Y()]\n   * of the text element el, i.e. the attributes anchorX, anchorY are ignored.\n   *\n   * <p>\n   * or labels, [0, 0, 0, 0] is returned.\n   *\n   * @returns Array\n   */\n  bounds: function () {\n    var c = this.coords.usrCoords;\n    if (Type.evaluate(this.visProp.islabel) || this.board.unitY === 0 || this.board.unitX === 0) {\n      return [0, 0, 0, 0];\n    }\n    return [c[1], c[2] + this.size[1] / this.board.unitY, c[1] + this.size[0] / this.board.unitX, c[2]];\n  },\n  /**\n   * Returns the value of the attribute \"anchorX\". If this equals \"auto\",\n   * returns \"left\", \"middle\", or \"right\", depending on the\n   * value of the attribute \"position\".\n   * @returns String\n   */\n  getAnchorX: function () {\n    var a = Type.evaluate(this.visProp.anchorx);\n    if (a === \"auto\") {\n      switch (this.visProp.position) {\n        case \"top\":\n        case \"bot\":\n          return \"middle\";\n        case \"rt\":\n        case \"lrt\":\n        case \"urt\":\n          return \"left\";\n        case \"lft\":\n        case \"llft\":\n        case \"ulft\":\n        default:\n          return \"right\";\n      }\n    }\n    return a;\n  },\n  /**\n   * Returns the value of the attribute \"anchorY\". If this equals \"auto\",\n   * returns \"bottom\", \"middle\", or \"top\", depending on the\n   * value of the attribute \"position\".\n   * @returns String\n   */\n  getAnchorY: function () {\n    var a = Type.evaluate(this.visProp.anchory);\n    if (a === \"auto\") {\n      switch (this.visProp.position) {\n        case \"top\":\n        case \"ulft\":\n        case \"urt\":\n          return \"bottom\";\n        case \"bot\":\n        case \"lrt\":\n        case \"llft\":\n          return \"top\";\n        case \"rt\":\n        case \"lft\":\n        default:\n          return \"middle\";\n      }\n    }\n    return a;\n  },\n  /**\n   * Computes the number of overlaps of a box of w pixels width, h pixels height\n   * and center (x, y)\n   *\n   * @private\n   * @param  {Number} x x-coordinate of the center (screen coordinates)\n   * @param  {Number} y y-coordinate of the center (screen coordinates)\n   * @param  {Number} w width of the box in pixel\n   * @param  {Number} h width of the box in pixel\n   * @return {Number}   Number of overlapping elements\n   */\n  getNumberOfConflicts: function (x, y, w, h) {\n    var count = 0,\n      i,\n      obj,\n      le,\n      savePointPrecision;\n\n    // Set the precision of hasPoint to half the max if label isn't too long\n    savePointPrecision = this.board.options.precision.hasPoint;\n    // this.board.options.precision.hasPoint = Math.max(w, h) * 0.5;\n    this.board.options.precision.hasPoint = (w + h) * 0.25;\n    // TODO:\n    // Make it compatible with the objects' visProp.precision attribute\n    for (i = 0, le = this.board.objectsList.length; i < le; i++) {\n      obj = this.board.objectsList[i];\n      if (obj.visPropCalc.visible && obj.elType !== \"axis\" && obj.elType !== \"ticks\" && obj !== this.board.infobox && obj !== this && obj.hasPoint(x, y)) {\n        count++;\n      }\n    }\n    this.board.options.precision.hasPoint = savePointPrecision;\n    return count;\n  },\n  /**\n   * Sets the offset of a label element to the position with the least number\n   * of overlaps with other elements, while retaining the distance to its\n   * anchor element. Twelve different angles are possible.\n   *\n   * @returns {JXG.Text} Reference to the text object.\n   */\n  setAutoPosition: function () {\n    var x,\n      y,\n      cx,\n      cy,\n      anchorCoords,\n      // anchorX, anchorY,\n      w = this.size[0],\n      h = this.size[1],\n      start_angle,\n      angle,\n      optimum = {\n        conflicts: Infinity,\n        angle: 0,\n        r: 0\n      },\n      max_r,\n      delta_r,\n      conflicts,\n      offset,\n      r,\n      num_positions = 12,\n      step = 2 * Math.PI / num_positions,\n      j,\n      dx,\n      dy,\n      co,\n      si;\n    if (this === this.board.infobox || !this.visPropCalc.visible || !Type.evaluate(this.visProp.islabel) || !this.element) {\n      return this;\n    }\n\n    // anchorX = Type.evaluate(this.visProp.anchorx);\n    // anchorY = Type.evaluate(this.visProp.anchory);\n    offset = Type.evaluate(this.visProp.offset);\n    anchorCoords = this.element.getLabelAnchor();\n    cx = anchorCoords.scrCoords[1];\n    cy = anchorCoords.scrCoords[2];\n\n    // Set dx, dy as the relative position of the center of the label\n    // to its anchor element ignoring anchorx and anchory.\n    dx = offset[0];\n    dy = offset[1];\n    conflicts = this.getNumberOfConflicts(cx + dx, cy - dy, w, h);\n    if (conflicts === 0) {\n      return this;\n    }\n    // console.log(this.id, conflicts, w, h);\n    // r = Geometry.distance([0, 0], offset, 2);\n\n    r = Type.evaluate(this.visProp.autopositionmindistance);\n    max_r = Type.evaluate(this.visProp.autopositionmaxdistance);\n    delta_r = 0.2 * r;\n    start_angle = Math.atan2(dy, dx);\n    optimum.conflicts = conflicts;\n    optimum.angle = start_angle;\n    optimum.r = r;\n    while (optimum.conflicts > 0 && r <= max_r) {\n      for (j = 1, angle = start_angle + step; j < num_positions && optimum.conflicts > 0; j++) {\n        co = Math.cos(angle);\n        si = Math.sin(angle);\n        x = cx + r * co;\n        y = cy - r * si;\n        conflicts = this.getNumberOfConflicts(x, y, w, h);\n        if (conflicts < optimum.conflicts) {\n          optimum.conflicts = conflicts;\n          optimum.angle = angle;\n          optimum.r = r;\n        }\n        if (optimum.conflicts === 0) {\n          break;\n        }\n        angle += step;\n      }\n      r += delta_r;\n    }\n    // console.log(this.id, \"after\", optimum)\n    r = optimum.r;\n    co = Math.cos(optimum.angle);\n    si = Math.sin(optimum.angle);\n    this.visProp.offset = [r * co, r * si];\n    if (co < -0.2) {\n      this.visProp.anchorx = \"right\";\n    } else if (co > 0.2) {\n      this.visProp.anchorx = \"left\";\n    } else {\n      this.visProp.anchorx = \"middle\";\n    }\n    return this;\n  }\n});\n\n/**\n * @class Construct and handle texts.\n *\n * The coordinates can either be abslute (i.e. respective to the coordinate system of the board) or be relative to the coordinates of an element\n * given in {@link Text#anchor}.\n * <p>\n * HTML, MathJaX, KaTeX and GEONExT syntax can be handled.\n * <p>\n * There are two ways to display texts:\n * <ul>\n * <li> using the text element of the renderer (canvas or svg). In most cases this is the suitable approach if speed matters.\n * However, advanced rendering like MathJax, KaTeX or HTML/CSS are not possible.\n * <li> using HTML &lt;div&gt;. This is the most flexible approach. The drawback is that HTML can only be display \"above\" the geometry elements.\n * If HTML should be displayed in an inbetween layer, conder to use an element of type {@link ForeignObject} (available in svg renderer, only).\n * </ul>\n * @pseudo\n * @name Text\n * @augments JXG.Text\n * @constructor\n * @type JXG.Text\n *\n * @param {number,function_number,function_number,function_String,function} z_,x,y,str Parent elements for text elements.\n *                     <p>\n *   Parent elements can be two or three elements of type number, a string containing a GEONE<sub>x</sub>T\n *   constraint, or a function which takes no parameter and returns a number. Every parent element beside the last determines one coordinate.\n *   If a coordinate is\n *   given by a number, the number determines the initial position of a free text. If given by a string or a function that coordinate will be constrained\n *   that means the user won't be able to change the texts's position directly by mouse because it will be calculated automatically depending on the string\n *   or the function's return value. If two parent elements are given the coordinates will be interpreted as 2D affine Euclidean coordinates, if three such\n *   parent elements are given they will be interpreted as homogeneous coordinates.\n *                     <p>\n *                     The text to display may be given as string or as function returning a string.\n *\n * There is the attribute 'display' which takes the values 'html' or 'internal'. In case of 'html' an HTML division tag is created to display\n * the text. In this case it is also possible to use MathJax, KaTeX, or ASCIIMathML. If neither of these is used, basic Math rendering is\n * applied.\n * <p>\n * In case of 'internal', an SVG text element is used to display the text.\n * @see JXG.Text\n * @example\n * // Create a fixed text at position [0,1].\n *   var t1 = board.create('text',[0,1,\"Hello World\"]);\n * </pre><div class=\"jxgbox\" id=\"JXG896013aa-f24e-4e83-ad50-7bc7df23f6b7\" style=\"width: 300px; height: 300px;\"></div>\n * <script type=\"text/javascript\">\n *   var t1_board = JXG.JSXGraph.initBoard('JXG896013aa-f24e-4e83-ad50-7bc7df23f6b7', {boundingbox: [-3, 6, 5, -3], axis: true, showcopyright: false, shownavigation: false});\n *   var t1 = t1_board.create('text',[0,1,\"Hello World\"]);\n * </script><pre>\n * @example\n * // Create a variable text at a variable position.\n *   var s = board.create('slider',[[0,4],[3,4],[-2,0,2]]);\n *   var graph = board.create('text',\n *                        [function(x){ return s.Value();}, 1,\n *                         function(){return \"The value of s is\"+JXG.toFixed(s.Value(), 2);}\n *                        ]\n *                     );\n * </pre><div class=\"jxgbox\" id=\"JXG5441da79-a48d-48e8-9e53-75594c384a1c\" style=\"width: 300px; height: 300px;\"></div>\n * <script type=\"text/javascript\">\n *   var t2_board = JXG.JSXGraph.initBoard('JXG5441da79-a48d-48e8-9e53-75594c384a1c', {boundingbox: [-3, 6, 5, -3], axis: true, showcopyright: false, shownavigation: false});\n *   var s = t2_board.create('slider',[[0,4],[3,4],[-2,0,2]]);\n *   var t2 = t2_board.create('text',[function(x){ return s.Value();}, 1, function(){return \"The value of s is \"+JXG.toFixed(s.Value(), 2);}]);\n * </script><pre>\n * @example\n * // Create a text bound to the point A\n * var p = board.create('point',[0, 1]),\n *     t = board.create('text',[0, -1,\"Hello World\"], {anchor: p});\n *\n * </pre><div class=\"jxgbox\" id=\"JXGff5a64b2-2b9a-11e5-8dd9-901b0e1b8723\" style=\"width: 300px; height: 300px;\"></div>\n * <script type=\"text/javascript\">\n *     (function() {\n *         var board = JXG.JSXGraph.initBoard('JXGff5a64b2-2b9a-11e5-8dd9-901b0e1b8723',\n *             {boundingbox: [-8, 8, 8,-8], axis: true, showcopyright: false, shownavigation: false});\n *     var p = board.create('point',[0, 1]),\n *         t = board.create('text',[0, -1,\"Hello World\"], {anchor: p});\n *\n *     })();\n *\n * </script><pre>\n *\n */\nJXG.createText = function (board, parents, attributes) {\n  var t,\n    attr = Type.copyAttributes(attributes, board.options, \"text\"),\n    coords = parents.slice(0, -1),\n    content = parents[parents.length - 1];\n\n  // downwards compatibility\n  attr.anchor = attr.parent || attr.anchor;\n  t = CoordsElement.create(JXG.Text, board, coords, attr, content);\n  if (!t) {\n    throw new Error(\"JSXGraph: Can't create text with parent types '\" + typeof parents[0] + \"' and '\" + typeof parents[1] + \"'.\" + \"\\nPossible parent types: [x,y], [z,x,y], [element,transformation]\");\n  }\n  if (attr.rotate !== 0) {\n    // This is the default value, i.e. no rotation\n    t.addRotation(attr.rotate);\n  }\n  return t;\n};\nJXG.registerElement(\"text\", JXG.createText);\n\n/**\n * @class Labels are text objects tied to other elements like points, lines and curves.\n * Labels are handled internally by JSXGraph, only. There is NO constructor \"board.create('label', ...)\".\n *\n * @pseudo\n * @name Label\n * @augments JXG.Text\n * @constructor\n * @type JXG.Text\n */\n//  See element.js#createLabel\n\n/**\n * [[x,y], [w px, h px], [range]\n */\nJXG.createHTMLSlider = function (board, parents, attributes) {\n  var t,\n    par,\n    attr = Type.copyAttributes(attributes, board.options, \"htmlslider\");\n  if (parents.length !== 2 || parents[0].length !== 2 || parents[1].length !== 3) {\n    throw new Error(\"JSXGraph: Can't create htmlslider with parent types '\" + typeof parents[0] + \"' and '\" + typeof parents[1] + \"'.\" + \"\\nPossible parents are: [[x,y], [min, start, max]]\");\n  }\n\n  // backwards compatibility\n  attr.anchor = attr.parent || attr.anchor;\n  attr.fixed = attr.fixed || true;\n  par = [parents[0][0], parents[0][1], '<form style=\"display:inline\">' + '<input type=\"range\" /><span></span><input type=\"text\" />' + \"</form>\"];\n  t = JXG.createText(board, par, attr);\n  t.type = Type.OBJECT_TYPE_HTMLSLIDER;\n  t.rendNodeForm = t.rendNode.childNodes[0];\n  t.rendNodeRange = t.rendNodeForm.childNodes[0];\n  t.rendNodeRange.min = parents[1][0];\n  t.rendNodeRange.max = parents[1][2];\n  t.rendNodeRange.step = attr.step;\n  t.rendNodeRange.value = parents[1][1];\n  t.rendNodeLabel = t.rendNodeForm.childNodes[1];\n  t.rendNodeLabel.id = t.rendNode.id + \"_label\";\n  if (attr.withlabel) {\n    t.rendNodeLabel.innerHTML = t.name + \"=\";\n  }\n  t.rendNodeOut = t.rendNodeForm.childNodes[2];\n  t.rendNodeOut.value = parents[1][1];\n  try {\n    t.rendNodeForm.id = t.rendNode.id + \"_form\";\n    t.rendNodeRange.id = t.rendNode.id + \"_range\";\n    t.rendNodeOut.id = t.rendNode.id + \"_out\";\n  } catch (e) {\n    JXG.debug(e);\n  }\n  t.rendNodeRange.style.width = attr.widthrange + \"px\";\n  t.rendNodeRange.style.verticalAlign = \"middle\";\n  t.rendNodeOut.style.width = attr.widthout + \"px\";\n  t._val = parents[1][1];\n  if (JXG.supportsVML()) {\n    /*\n     * OnChange event is used for IE browsers\n     * The range element is supported since IE10\n     */\n    Env.addEvent(t.rendNodeForm, \"change\", priv.HTMLSliderInputEventHandler, t);\n  } else {\n    /*\n     * OnInput event is used for non-IE browsers\n     */\n    Env.addEvent(t.rendNodeForm, \"input\", priv.HTMLSliderInputEventHandler, t);\n  }\n  t.Value = function () {\n    return this._val;\n  };\n  return t;\n};\nJXG.registerElement(\"htmlslider\", JXG.createHTMLSlider);\nexport default JXG.Text;\n// export default {\n//     Text: JXG.Text,\n//     createText: JXG.createText,\n//     createHTMLSlider: JXG.createHTMLSlider\n// };","map":{"version":3,"names":["JXG","Const","GeometryElement","GeonextParser","Env","Type","Mat","CoordsElement","priv","HTMLSliderInputEventHandler","_val","parseFloat","rendNodeRange","value","rendNodeOut","board","update","Text","coords","attributes","content","tmp","constructor","OBJECT_TYPE_TEXT","OBJECT_CLASS_TEXT","element","select","anchor","coordsConstructor","evaluate","visProp","islabel","plaintext","plaintextOld","orgText","needsSizeUpdate","hiddenByParent","size","id","setId","renderer","drawText","finalizeAdding","visible","setText","isString","notifyParents","elType","methodMap","deepCopy","prototype","copyPrototypeMethods","extend","hasPoint","x","y","lft","rt","top","bot","ax","ay","type","r","isObject","precision","_inputDevice","options","transformations","length","matVecMult","inverse","joinTransforms","getAnchorX","scrCoords","getAnchorY","dragarea","_createFctUpdateText","text","updateText","e","digits","resolvedText","i","that","ev_p","parse","ev_um","usemathjax","ev_uk","usekatex","convertJessieCode","isFunction","toString","replaceSub","replaceSup","convertGeonextAndSketchometry2CSS","isNumber","useLocale","formatNumberLocale","toFixed","useasciimathml","valueTagToJessieCode","isArray","replace","poorMansTeX","jc","snippet","deps","addParents","addChild","t","txt","at","slice","unescapeTicks","_setText","fullUpdate","infobox","updateSize","setTextJessieCode","s","castext","sanitizeHTML","node","ev_d","display","isBrowser","rendNode","exists","offsetWidth","window","setTimeout","offsetHeight","needsUpdate","updateRenderer","crudeSizeEstimate","getBBox","width","height","ev_fs","fontsize","utf8_decode","string","m","p1","String","fromCharCode","parseInt","te","indexOf","j","getSize","setCoords","coordsAnchor","dx","dy","getLabelAnchor","usrCoords","unitX","unitY","relativeCoords","setCoordinates","COORDS_BY_SCREEN","COORDS_BY_USER","fromParent","updateCoords","checkForSizeUpdate","autoposition","setAutoPosition","updateConstraint","updateRendererGeneric","expandShortMath","expr","re","generateTerm","contentStr","expand","avoidGeonext2JS","res","term","geonext2JS","bind","textComps","tick","push","escapeTicks","a","convertGeonext2CSS","convertSketchometry2CSS","escape","t1","t2","search","exec","findDependencies","index","getParents","p","undefined","Z","X","Y","parents","bounds","c","anchorx","position","anchory","getNumberOfConflicts","w","h","count","obj","le","savePointPrecision","objectsList","visPropCalc","cx","cy","anchorCoords","start_angle","angle","optimum","conflicts","Infinity","max_r","delta_r","offset","num_positions","step","Math","PI","co","si","autopositionmindistance","autopositionmaxdistance","atan2","cos","sin","createText","attr","copyAttributes","parent","create","Error","rotate","addRotation","registerElement","createHTMLSlider","par","fixed","OBJECT_TYPE_HTMLSLIDER","rendNodeForm","childNodes","min","max","rendNodeLabel","withlabel","innerHTML","name","debug","style","widthrange","verticalAlign","widthout","supportsVML","addEvent","Value"],"sources":["D:/study things/web/weblab4-main/node_modules/jsxgraph/src/base/text.js"],"sourcesContent":["/*\n    Copyright 2008-2023\n        Matthias Ehmann,\n        Michael Gerhaeuser,\n        Carsten Miller,\n        Bianca Valentin,\n        Alfred Wassermann,\n        Peter Wilfahrt\n\n    This file is part of JSXGraph.\n\n    JSXGraph is free software dual licensed under the GNU LGPL or MIT License.\n\n    You can redistribute it and/or modify it under the terms of the\n\n      * GNU Lesser General Public License as published by\n        the Free Software Foundation, either version 3 of the License, or\n        (at your option) any later version\n      OR\n      * MIT License: https://github.com/jsxgraph/jsxgraph/blob/master/LICENSE.MIT\n\n    JSXGraph is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License and\n    the MIT License along with JSXGraph. If not, see <https://www.gnu.org/licenses/>\n    and <https://opensource.org/licenses/MIT/>.\n */\n\n/*global JXG: true, define: true, window: true*/\n/*jslint nomen: true, plusplus: true*/\n\n/**\n * @fileoverview In this file the Text element is defined.\n */\n\nimport JXG from \"../jxg\";\nimport Const from \"./constants\";\nimport GeometryElement from \"./element\";\nimport GeonextParser from \"../parser/geonext\";\nimport Env from \"../utils/env\";\nimport Type from \"../utils/type\";\nimport Mat from \"../math/math\";\nimport CoordsElement from \"./coordselement\";\n\nvar priv = {\n    /**\n     * @class\n     * @ignore\n     */\n    HTMLSliderInputEventHandler: function () {\n        this._val = parseFloat(this.rendNodeRange.value);\n        this.rendNodeOut.value = this.rendNodeRange.value;\n        this.board.update();\n    }\n};\n\n/**\n * Construct and handle texts.\n *\n * The coordinates can be relative to the coordinates of an element\n * given in {@link JXG.Options#text.anchor}.\n *\n * MathJax, HTML and GEONExT syntax can be handled.\n * @class Creates a new text object. Do not use this constructor to create a text. Use {@link JXG.Board#create} with\n * type {@link Text} instead.\n * @augments JXG.GeometryElement\n * @augments JXG.CoordsElement\n * @param {string|JXG.Board} board The board the new text is drawn on.\n * @param {Array} coordinates An array with the user coordinates of the text.\n * @param {Object} attributes An object containing visual properties and optional a name and a id.\n * @param {string|function} content A string or a function returning a string.\n *\n */\nJXG.Text = function (board, coords, attributes, content) {\n    var tmp;\n\n    this.constructor(board, attributes, Const.OBJECT_TYPE_TEXT, Const.OBJECT_CLASS_TEXT);\n\n    this.element = this.board.select(attributes.anchor);\n    this.coordsConstructor(coords, Type.evaluate(this.visProp.islabel));\n\n    this.content = \"\";\n    this.plaintext = \"\";\n    this.plaintextOld = null;\n    this.orgText = \"\";\n\n    this.needsSizeUpdate = false;\n    // Only used by infobox anymore\n    this.hiddenByParent = false;\n\n    /**\n     * Width and height of the text element in pixel.\n     *\n     * @private\n     * @type Array\n     */\n    this.size = [1.0, 1.0];\n    this.id = this.board.setId(this, \"T\");\n\n    this.board.renderer.drawText(this);\n    this.board.finalizeAdding(this);\n\n    // Set text before drawing\n    // this._createFctUpdateText(content);\n    // this.updateText();\n\n    // Set attribute visible to true. This is necessary to\n    // create all sub-elements for button, input and checkbox\n    tmp = this.visProp.visible;\n    this.visProp.visible = true;\n    this.setText(content);\n    // Restore the correct attribute visible.\n    this.visProp.visible = tmp;\n\n    if (Type.isString(this.content)) {\n        this.notifyParents(this.content);\n    }\n    this.elType = \"text\";\n\n    this.methodMap = Type.deepCopy(this.methodMap, {\n        setText: \"setTextJessieCode\"\n        // free: 'free',\n        // move: \"setCoords\"\n    });\n};\n\nJXG.Text.prototype = new GeometryElement();\nType.copyPrototypeMethods(JXG.Text, CoordsElement, \"coordsConstructor\");\n\nJXG.extend(\n    JXG.Text.prototype,\n    /** @lends JXG.Text.prototype */ {\n        /**\n         * @private\n         * @param {Number} x\n         * @param {Number} y\n         * @returns {Boolean}\n        */\n        // Test if the screen coordinates (x,y) are in a small stripe\n        // at the left side or at the right side of the text.\n        // Sensitivity is set in this.board.options.precision.hasPoint.\n        // If dragarea is set to 'all' (default), tests if the screen\n        // coordinates (x,y) are in within the text boundary.\n        hasPoint: function (x, y) {\n            var lft, rt, top, bot, ax, ay, type, r;\n\n            if (Type.isObject(Type.evaluate(this.visProp.precision))) {\n                type = this.board._inputDevice;\n                r = Type.evaluate(this.visProp.precision[type]);\n            } else {\n                // 'inherit'\n                r = this.board.options.precision.hasPoint;\n            }\n            if (this.transformations.length > 0) {\n                //Transform the mouse/touch coordinates\n                // back to the original position of the text.\n                lft = Mat.matVecMult(\n                    Mat.inverse(this.board.renderer.joinTransforms(this, this.transformations)),\n                    [1, x, y]\n                );\n                x = lft[1];\n                y = lft[2];\n            }\n\n            ax = this.getAnchorX();\n            if (ax === \"right\") {\n                lft = this.coords.scrCoords[1] - this.size[0];\n            } else if (ax === \"middle\") {\n                lft = this.coords.scrCoords[1] - 0.5 * this.size[0];\n            } else {\n                lft = this.coords.scrCoords[1];\n            }\n            rt = lft + this.size[0];\n\n            ay = this.getAnchorY();\n            if (ay === \"top\") {\n                bot = this.coords.scrCoords[2] + this.size[1];\n            } else if (ay === \"middle\") {\n                bot = this.coords.scrCoords[2] + 0.5 * this.size[1];\n            } else {\n                bot = this.coords.scrCoords[2];\n            }\n            top = bot - this.size[1];\n\n            if (Type.evaluate(this.visProp.dragarea) === \"all\") {\n                return x >= lft - r && x < rt + r && y >= top - r && y <= bot + r;\n            }\n            // e.g. 'small'\n            return (\n                y >= top - r &&\n                y <= bot + r &&\n                ((x >= lft - r && x <= lft + 2 * r) || (x >= rt - 2 * r && x <= rt + r))\n            );\n        },\n\n        /**\n         * This sets the updateText function of this element depending on the type of text content passed.\n         * Used by {@link JXG.Text#_setText}.\n         * @param {String|Function|Number} text\n         * @private\n         * @see JXG.Text#_setText\n         */\n        _createFctUpdateText: function (text) {\n            var updateText, e, digits,\n                resolvedText,\n                i, that,\n                ev_p = Type.evaluate(this.visProp.parse),\n                ev_um = Type.evaluate(this.visProp.usemathjax),\n                ev_uk = Type.evaluate(this.visProp.usekatex),\n                convertJessieCode = false;\n\n            this.orgText = text;\n\n            if (Type.isFunction(text)) {\n                /**\n                 * Dynamically created function to update the content\n                 * of a text. Can not be overwritten.\n                 * <p>\n                 * &lt;value&gt; tags will not be evaluated if text is provided by a function\n                 * <p>\n                 * Sets the property <tt>plaintext</tt> of the text element.\n                 *\n                 * @private\n                 */\n                this.updateText = function () {\n                    resolvedText = text().toString(); // Evaluate function\n                    if (ev_p && !ev_um && !ev_uk) {\n                        this.plaintext = this.replaceSub(\n                            this.replaceSup(\n                                this.convertGeonextAndSketchometry2CSS(resolvedText, false)\n                            )\n                        );\n                    } else {\n                        this.plaintext = resolvedText;\n                    }\n                };\n            } else {\n                if (Type.isNumber(text)) {\n                    digits = Type.evaluate(this.visProp.digits);\n                    if (this.useLocale()) {\n                        this.content = this.formatNumberLocale(text, digits);\n                    } else {\n                        this.content = Type.toFixed(text, digits);\n                    }\n                } else if (Type.isString(text) && ev_p) {\n                    if (Type.evaluate(this.visProp.useasciimathml)) {\n                        // ASCIIMathML\n                        // value-tags are not supported\n                        this.content = \"'`\" + text + \"`'\";\n                    } else if (ev_um || ev_uk) {\n                        // MathJax or KaTeX\n                        // Replace value-tags by functions\n                        // sketchofont is ignored\n                        this.content = this.valueTagToJessieCode(text);\n                        if (!Type.isArray(this.content)) {\n                            // For some reason we don't have to mask backslashes in an array of strings\n                            // anymore.\n                            //\n                            // for (i = 0; i < this.content.length; i++) {\n                            //     this.content[i] = this.content[i].replace(/\\\\/g, \"\\\\\\\\\"); // Replace single backslash by double\n                            // }\n                            // } else {\n                            this.content = this.content.replace(/\\\\/g, \"\\\\\\\\\"); // Replace single backslash by double\n                        }\n                    } else {\n                        // No TeX involved.\n                        // Converts GEONExT syntax into JavaScript string\n                        // Short math is allowed\n                        // Replace value-tags by functions\n                        // Avoid geonext2JS calls\n                        this.content = this.poorMansTeX(this.valueTagToJessieCode(text));\n                    }\n                    convertJessieCode = true;\n                } else {\n                    this.content = text;\n                }\n\n                // Generate function which returns the text to be displayed\n                if (convertJessieCode) {\n                    // Convert JessieCode to JS function\n                    if (Type.isArray(this.content)) {\n                        // This is the case if the text contained value-tags.\n                        // These value-tags consist of JessieCode snippets\n                        // which are now replaced by JavaScript functions\n                        that = this;\n                        for (i = 0; i < this.content.length; i++) {\n                            if (this.content[i][0] !== '\"') {\n                                this.content[i] = this.board.jc.snippet(this.content[i], true, \"\", false);\n                                for (e in this.content[i].deps) {\n                                    this.addParents(this.content[i].deps[e]);\n                                    this.content[i].deps[e].addChild(this);\n                                }\n                            }\n                        }\n\n                        updateText = function() {\n                            var i, t,\n                                digits = Type.evaluate(that.visProp.digits),\n                                txt = '';\n\n                            for (i = 0; i < that.content.length; i++) {\n                                if (Type.isFunction(that.content[i])) {\n                                    t = that.content[i]();\n                                    if (that.useLocale()) {\n                                        t = that.formatNumberLocale(t, digits);\n                                    } else {\n                                        t = Type.toFixed(t, digits);\n                                    }\n                                } else {\n                                    t = that.content[i];\n                                    if (t.at(0) === '\"' && t.at(-1) === '\"') {\n                                        t = t.slice(1, -1);\n                                    }\n                                }\n\n                                txt += t;\n                            }\n                            return txt;\n                        };\n                    } else {\n                        updateText = this.board.jc.snippet(this.content, true, \"\", false);\n                        for (e in updateText.deps) {\n                            this.addParents(updateText.deps[e]);\n                            updateText.deps[e].addChild(this);\n                        }\n                    }\n\n                    // Ticks have been escaped in valueTagToJessieCode\n                    this.updateText = function () {\n                        this.plaintext = this.unescapeTicks(updateText());\n                    };\n                } else {\n                    this.updateText = function () {\n                        this.plaintext = this.content; // text;\n                    };\n                }\n            }\n        },\n\n        /**\n         * Defines new content. This is used by {@link JXG.Text#setTextJessieCode} and {@link JXG.Text#setText}. This is required because\n         * JessieCode needs to filter all Texts inserted into the DOM and thus has to replace setText by setTextJessieCode.\n         * @param {String|Function|Number} text\n         * @returns {JXG.Text}\n         * @private\n         */\n        _setText: function (text) {\n            this._createFctUpdateText(text);\n\n            // First evaluation of the string.\n            // We need this for display='internal' and Canvas\n            this.updateText();\n            this.fullUpdate();\n\n            // We do not call updateSize for the infobox to speed up rendering\n            if (!this.board.infobox || this.id !== this.board.infobox.id) {\n                this.updateSize(); // updateSize() is called at least once.\n            }\n\n            // This may slow down canvas renderer\n            // if (this.board.renderer.type === 'canvas') {\n            //     this.board.fullUpdate();\n            // }\n\n            return this;\n        },\n\n        /**\n         * Defines new content but converts &lt; and &gt; to HTML entities before updating the DOM.\n         * @param {String|function} text\n         */\n        setTextJessieCode: function (text) {\n            var s;\n\n            this.visProp.castext = text;\n            if (Type.isFunction(text)) {\n                s = function () {\n                    return Type.sanitizeHTML(text());\n                };\n            } else {\n                if (Type.isNumber(text)) {\n                    s = text;\n                } else {\n                    s = Type.sanitizeHTML(text);\n                }\n            }\n\n            return this._setText(s);\n        },\n\n        /**\n         * Defines new content.\n         * @param {String|function} text\n         * @returns {JXG.Text} Reference to the text object.\n         */\n        setText: function (text) {\n            return this._setText(text);\n        },\n\n        /**\n         * Recompute the width and the height of the text box.\n         * Updates the array {@link JXG.Text#size} with pixel values.\n         * The result may differ from browser to browser\n         * by some pixels.\n         * In canvas an old IEs we use a very crude estimation of the dimensions of\n         * the textbox.\n         * JSXGraph needs {@link JXG.Text#size} for applying rotations in IE and\n         * for aligning text.\n         *\n         * @return {this} [description]\n         */\n        updateSize: function () {\n            var tmp,\n                that,\n                node,\n                ev_d = Type.evaluate(this.visProp.display);\n\n            if (!Env.isBrowser || this.board.renderer.type === \"no\") {\n                return this;\n            }\n            node = this.rendNode;\n\n            /**\n             * offsetWidth and offsetHeight seem to be supported for internal vml elements by IE10+ in IE8 mode.\n             */\n            if (ev_d === \"html\" || this.board.renderer.type === \"vml\") {\n                if (Type.exists(node.offsetWidth)) {\n                    that = this;\n                    window.setTimeout(function () {\n                        that.size = [node.offsetWidth, node.offsetHeight];\n                        that.needsUpdate = true;\n                        that.updateRenderer();\n                    }, 0);\n                    // In case, there is non-zero padding or borders\n                    // the following approach does not longer work.\n                    // s = [node.offsetWidth, node.offsetHeight];\n                    // if (s[0] === 0 && s[1] === 0) { // Some browsers need some time to set offsetWidth and offsetHeight\n                    //     that = this;\n                    //     window.setTimeout(function () {\n                    //         that.size = [node.offsetWidth, node.offsetHeight];\n                    //         that.needsUpdate = true;\n                    //         that.updateRenderer();\n                    //     }, 0);\n                    // } else {\n                    //     this.size = s;\n                    // }\n                } else {\n                    this.size = this.crudeSizeEstimate();\n                }\n            } else if (ev_d === \"internal\") {\n                if (this.board.renderer.type === \"svg\") {\n                    that = this;\n                    window.setTimeout(function () {\n                        try {\n                            tmp = node.getBBox();\n                            that.size = [tmp.width, tmp.height];\n                            that.needsUpdate = true;\n                            that.updateRenderer();\n                        } catch (e) {}\n                    }, 0);\n                } else if (this.board.renderer.type === \"canvas\") {\n                    this.size = this.crudeSizeEstimate();\n                }\n            }\n\n            return this;\n        },\n\n        /**\n         * A very crude estimation of the dimensions of the textbox in case nothing else is available.\n         * @returns {Array}\n         */\n        crudeSizeEstimate: function () {\n            var ev_fs = parseFloat(Type.evaluate(this.visProp.fontsize));\n            return [ev_fs * this.plaintext.length * 0.45, ev_fs * 0.9];\n        },\n\n        /**\n         * Decode unicode entities into characters.\n         * @param {String} string\n         * @returns {String}\n         */\n        utf8_decode: function (string) {\n            return string.replace(/&#x(\\w+);/g, function (m, p1) {\n                return String.fromCharCode(parseInt(p1, 16));\n            });\n        },\n\n        /**\n         * Replace _{} by &lt;sub&gt;\n         * @param {String} te String containing _{}.\n         * @returns {String} Given string with _{} replaced by &lt;sub&gt;.\n         */\n        replaceSub: function (te) {\n            if (!te.indexOf) {\n                return te;\n            }\n\n            var j,\n                i = te.indexOf(\"_{\");\n\n            // The regexp in here are not used for filtering but to provide some kind of sugar for label creation,\n            // i.e. replacing _{...} with <sub>...</sub>. What is passed would get out anyway.\n            /*jslint regexp: true*/\n            while (i >= 0) {\n                te = te.slice(0, i) + te.slice(i).replace(/_\\{/, \"<sub>\");\n                j = te.indexOf(\"}\", i + 4);\n                if (j >= 0) {\n                    te = te.slice(0, j) + te.slice(j).replace(/\\}/, \"</sub>\");\n                }\n                i = te.indexOf(\"_{\");\n            }\n\n            i = te.indexOf(\"_\");\n            while (i >= 0) {\n                te = te.slice(0, i) + te.slice(i).replace(/_(.?)/, \"<sub>$1</sub>\");\n                i = te.indexOf(\"_\");\n            }\n\n            return te;\n        },\n\n        /**\n         * Replace ^{} by &lt;sup&gt;\n         * @param {String} te String containing ^{}.\n         * @returns {String} Given string with ^{} replaced by &lt;sup&gt;.\n         */\n        replaceSup: function (te) {\n            if (!te.indexOf) {\n                return te;\n            }\n\n            var j,\n                i = te.indexOf(\"^{\");\n\n            // The regexp in here are not used for filtering but to provide some kind of sugar for label creation,\n            // i.e. replacing ^{...} with <sup>...</sup>. What is passed would get out anyway.\n            /*jslint regexp: true*/\n            while (i >= 0) {\n                te = te.slice(0, i) + te.slice(i).replace(/\\^\\{/, \"<sup>\");\n                j = te.indexOf(\"}\", i + 4);\n                if (j >= 0) {\n                    te = te.slice(0, j) + te.slice(j).replace(/\\}/, \"</sup>\");\n                }\n                i = te.indexOf(\"^{\");\n            }\n\n            i = te.indexOf(\"^\");\n            while (i >= 0) {\n                te = te.slice(0, i) + te.slice(i).replace(/\\^(.?)/, \"<sup>$1</sup>\");\n                i = te.indexOf(\"^\");\n            }\n\n            return te;\n        },\n\n        /**\n         * Return the width of the text element.\n         * @returns {Array} [width, height] in pixel\n         */\n        getSize: function () {\n            return this.size;\n        },\n\n        /**\n         * Move the text to new coordinates.\n         * @param {number} x\n         * @param {number} y\n         * @returns {object} reference to the text object.\n         */\n        setCoords: function (x, y) {\n            var coordsAnchor, dx, dy;\n            if (Type.isArray(x) && x.length > 1) {\n                y = x[1];\n                x = x[0];\n            }\n\n            if (Type.evaluate(this.visProp.islabel) && Type.exists(this.element)) {\n                coordsAnchor = this.element.getLabelAnchor();\n                dx = (x - coordsAnchor.usrCoords[1]) * this.board.unitX;\n                dy = -(y - coordsAnchor.usrCoords[2]) * this.board.unitY;\n\n                this.relativeCoords.setCoordinates(Const.COORDS_BY_SCREEN, [dx, dy]);\n            } else {\n                /*\n                this.X = function () {\n                    return x;\n                };\n\n                this.Y = function () {\n                    return y;\n                };\n                */\n                this.coords.setCoordinates(Const.COORDS_BY_USER, [x, y]);\n            }\n\n            // this should be a local update, otherwise there might be problems\n            // with the tick update routine resulting in orphaned tick labels\n            this.fullUpdate();\n\n            return this;\n        },\n\n        /**\n         * Evaluates the text.\n         * Then, the update function of the renderer\n         * is called.\n         */\n        update: function (fromParent) {\n            if (!this.needsUpdate) {\n                return this;\n            }\n\n            this.updateCoords(fromParent);\n            this.updateText();\n\n            if (Type.evaluate(this.visProp.display) === \"internal\") {\n                if (Type.isString(this.plaintext)) {\n                    this.plaintext = this.utf8_decode(this.plaintext);\n                }\n            }\n\n            this.checkForSizeUpdate();\n            if (this.needsSizeUpdate) {\n                this.updateSize();\n            }\n\n            return this;\n        },\n\n        /**\n         * Used to save updateSize() calls.\n         * Called in JXG.Text.update\n         * That means this.update() has been called.\n         * More tests are in JXG.Renderer.updateTextStyle. The latter tests\n         * are one update off. But this should pose not too many problems, since\n         * it affects fontSize and cssClass changes.\n         *\n         * @private\n         */\n        checkForSizeUpdate: function () {\n            if (this.board.infobox && this.id === this.board.infobox.id) {\n                this.needsSizeUpdate = false;\n            } else {\n                // For some magic reason it is more efficient on the iPad to\n                // call updateSize() for EVERY text element EVERY time.\n                this.needsSizeUpdate = this.plaintextOld !== this.plaintext;\n\n                if (this.needsSizeUpdate) {\n                    this.plaintextOld = this.plaintext;\n                }\n            }\n        },\n\n        /**\n         * The update function of the renderer\n         * is called.\n         * @private\n         */\n        updateRenderer: function () {\n            if (\n                //this.board.updateQuality === this.board.BOARD_QUALITY_HIGH &&\n                Type.evaluate(this.visProp.autoposition)\n            ) {\n                this.setAutoPosition().updateConstraint();\n            }\n            return this.updateRendererGeneric(\"updateText\");\n        },\n\n        /**\n         * Converts shortened math syntax into correct syntax:  3x instead of 3*x or\n         * (a+b)(3+1) instead of (a+b)*(3+1).\n         *\n         * @private\n         * @param{String} expr Math term\n         * @returns {string} expanded String\n         */\n        expandShortMath: function (expr) {\n            var re = /([)0-9.])\\s*([(a-zA-Z_])/g;\n            return expr.replace(re, \"$1*$2\");\n        },\n\n        /**\n         * Converts the GEONExT syntax of the <value> terms into JavaScript.\n         * Also, all Objects whose name appears in the term are searched and\n         * the text is added as child to these objects.\n         * This method is called if the attribute parse==true is set.\n         *\n         * Obsolete, replaced by JXG.Text.valueTagToJessieCode\n         *\n         * @param{String} contentStr String to be parsed\n         * @param{Boolean} [expand] Optional flag if shortened math syntax is allowed (e.g. 3x instead of 3*x).\n         * @param{Boolean} [avoidGeonext2JS] Optional flag if geonext2JS should be called. For backwards compatibility\n         * this has to be set explicitly to true.\n         * @param{Boolean} [outputTeX] Optional flag which has to be true if the resulting term will be sent to MathJax or KaTeX.\n         * If true, \"_\" and \"^\" are NOT replaced by HTML tags sub and sup. Default: false, i.e. the replacement is done.\n         * This flag allows the combination of &lt;value&gt; tag containing calculations with TeX output.\n         *\n         * @deprecated\n         * @private\n         * @see JXG.GeonextParser#geonext2JS\n         * @see JXG.Text#valueTagToJessieCode\n         *\n         */\n        generateTerm: function (contentStr, expand, avoidGeonext2JS) {\n            var res,\n                term,\n                i,\n                j,\n                plaintext = '\"\"';\n\n            // Revert possible jc replacement\n            contentStr = contentStr || \"\";\n            contentStr = contentStr.replace(/\\r/g, \"\");\n            contentStr = contentStr.replace(/\\n/g, \"\");\n            contentStr = contentStr.replace(/\"/g, \"'\");\n            contentStr = contentStr.replace(/'/g, \"\\\\'\");\n\n            // Old GEONExT syntax, not (yet) supported as TeX output.\n            // Otherwise, the else clause should be used.\n            // That means, i.e. the <arc> tag and <sqrt> tag are not\n            // converted into TeX syntax.\n            contentStr = contentStr.replace(/&amp;arc;/g, \"&ang;\");\n            contentStr = contentStr.replace(/<arc\\s*\\/>/g, \"&ang;\");\n            contentStr = contentStr.replace(/&lt;arc\\s*\\/&gt;/g, \"&ang;\");\n            contentStr = contentStr.replace(/&lt;sqrt\\s*\\/&gt;/g, \"&radic;\");\n\n            contentStr = contentStr.replace(/&lt;value&gt;/g, \"<value>\");\n            contentStr = contentStr.replace(/&lt;\\/value&gt;/g, \"</value>\");\n\n            // Convert GEONExT syntax into  JavaScript syntax\n            i = contentStr.indexOf(\"<value>\");\n            j = contentStr.indexOf(\"</value>\");\n            if (i >= 0) {\n                while (i >= 0) {\n                    plaintext +=\n                        ' + \"' + this.replaceSub(this.replaceSup(contentStr.slice(0, i))) + '\"';\n                    // plaintext += ' + \"' + this.replaceSub(contentStr.slice(0, i)) + '\"';\n\n                    term = contentStr.slice(i + 7, j);\n                    term = term.replace(/\\s+/g, \"\"); // Remove all whitespace\n                    if (expand === true) {\n                        term = this.expandShortMath(term);\n                    }\n                    if (avoidGeonext2JS) {\n                        res = term;\n                    } else {\n                        res = GeonextParser.geonext2JS(term, this.board);\n                    }\n                    res = res.replace(/\\\\\"/g, \"'\");\n                    res = res.replace(/\\\\'/g, \"'\");\n\n                    // GEONExT-Hack: apply rounding once only.\n                    if (res.indexOf(\"toFixed\") < 0) {\n                        // output of a value tag\n                        if (\n                            Type.isNumber(\n                                Type.bind(this.board.jc.snippet(res, true, '', false), this)()\n                            )\n                        ) {\n                            // may also be a string\n                            plaintext += '+(' + res + ').toFixed(' + Type.evaluate(this.visProp.digits) + ')';\n                        } else {\n                            plaintext += '+(' + res + ')';\n                        }\n                    } else {\n                        plaintext += '+(' + res + ')';\n                    }\n\n                    contentStr = contentStr.slice(j + 8);\n                    i = contentStr.indexOf(\"<value>\");\n                    j = contentStr.indexOf(\"</value>\");\n                }\n            }\n\n            plaintext += ' + \"' + this.replaceSub(this.replaceSup(contentStr)) + '\"';\n            plaintext = this.convertGeonextAndSketchometry2CSS(plaintext);\n\n            // This should replace e.g. &amp;pi; by &pi;\n            plaintext = plaintext.replace(/&amp;/g, \"&\");\n            plaintext = plaintext.replace(/\"/g, \"'\");\n\n            return plaintext;\n        },\n\n        /**\n         * Replace value-tags in string by JessieCode functions.\n         * @param {String} contentStr\n         * @returns String\n         * @private\n         * @example\n         * \"The x-coordinate of A is &lt;value&gt;X(A)&lt;/value&gt;\"\n         *\n         */\n        valueTagToJessieCode: function (contentStr) {\n            var res, term,\n                i, j,\n                expandShortMath = true,\n                textComps = [],\n                tick = '\"';\n\n            contentStr = contentStr || \"\";\n            contentStr = contentStr.replace(/\\r/g, \"\");\n            contentStr = contentStr.replace(/\\n/g, \"\");\n\n            contentStr = contentStr.replace(/&lt;value&gt;/g, \"<value>\");\n            contentStr = contentStr.replace(/&lt;\\/value&gt;/g, \"</value>\");\n\n            // Convert content of value tag (GEONExT/JessieCode) syntax into JavaScript syntax\n            i = contentStr.indexOf(\"<value>\");\n            j = contentStr.indexOf(\"</value>\");\n            if (i >= 0) {\n                while (i >= 0) {\n                    // Add string fragment before <value> tag\n                    textComps.push(tick + this.escapeTicks(contentStr.slice(0, i)) + tick);\n\n                    term = contentStr.slice(i + 7, j);\n                    term = term.replace(/\\s+/g, \"\"); // Remove all whitespace\n                    if (expandShortMath === true) {\n                        term = this.expandShortMath(term);\n                    }\n                    res = term;\n                    res = res.replace(/\\\\\"/g, \"'\").replace(/\\\\'/g, \"'\");\n\n                    // // Hack: apply rounding once only.\n                    // if (res.indexOf(\"toFixed\") < 0) {\n                    //     // Output of a value tag\n                    //     // Run the JessieCode parser\n                    //     if (\n                    //         Type.isNumber(\n                    //             Type.bind(this.board.jc.snippet(res, true, \"\", false), this)()\n                    //         )\n                    //     ) {\n                    //         // Output is number\n                    //         // textComps.push(\n                    //         //     '(' + res + ').toFixed(' + Type.evaluate(this.visProp.digits) + ')'\n                    //         // );\n                    //         textComps.push('(' + res + ')');\n                    //     } else {\n                    //         // Output is a string\n                    //         textComps.push(\"(\" + res + \")\");\n                    //     }\n                    // } else {\n                        textComps.push(\"(\" + res + \")\");\n                    // }\n                    contentStr = contentStr.slice(j + 8);\n                    i = contentStr.indexOf(\"<value>\");\n                    j = contentStr.indexOf(\"</value>\");\n                }\n            }\n            // Add trailing string fragment\n            textComps.push(tick + this.escapeTicks(contentStr) + tick);\n\n            // return textComps.join(\" + \").replace(/&amp;/g, \"&\");\n            for (i = 0; i < textComps.length; i++) {\n                textComps[i] = textComps[i].replace(/&amp;/g, \"&\");\n            }\n            return textComps;\n        },\n\n        /**\n         * Simple math rendering using HTML / CSS only. In case of array,\n         * handle each entry separately and return array with the\n         * rendering strings.\n         *\n         * @param {String|Array} s\n         * @returns {String|Array}\n         * @see JXG.Text#convertGeonextAndSketchometry2CSS\n         * @private\n         * @see JXG.Text#replaceSub\n         * @see JXG.Text#replaceSup\n         * @see JXG.Text#convertGeonextAndSketchometry2CSS\n         */\n        poorMansTeX: function (s) {\n            var i, a;\n            if (Type.isArray(s)) {\n                a = [];\n                for (i = 0; i < s.length; i++) {\n                    a.push(this.poorMansTeX(s[i]));\n                }\n                return a;\n            }\n\n            s = s\n                .replace(/<arc\\s*\\/*>/g, \"&ang;\")\n                .replace(/&lt;arc\\s*\\/*&gt;/g, \"&ang;\")\n                .replace(/<sqrt\\s*\\/*>/g, \"&radic;\")\n                .replace(/&lt;sqrt\\s*\\/*&gt;/g, \"&radic;\");\n            return this.convertGeonextAndSketchometry2CSS(this.replaceSub(this.replaceSup(s)), true);\n        },\n\n        /**\n         * Replace ticks by URI escape sequences\n         *\n         * @param {String} s\n         * @returns String\n         * @private\n         *\n         */\n        escapeTicks: function (s) {\n            return s.replace(/\"/g, \"%22\").replace(/'/g, \"%27\");\n        },\n\n        /**\n         * Replace escape sequences for ticks by ticks\n         *\n         * @param {String} s\n         * @returns String\n         * @private\n         */\n        unescapeTicks: function (s) {\n            return s.replace(/%22/g, '\"').replace(/%27/g, \"'\");\n        },\n\n        /**\n         * Converts the GEONExT tags <overline> and <arrow> to\n         * HTML span tags with proper CSS formatting.\n         * @private\n         * @see JXG.Text.poorMansTeX\n         * @see JXG.Text._setText\n         */\n        convertGeonext2CSS: function (s) {\n            if (Type.isString(s)) {\n                s = s.replace(\n                    /(<|&lt;)overline(>|&gt;)/g,\n                    \"<span style=text-decoration:overline;>\"\n                );\n                s = s.replace(/(<|&lt;)\\/overline(>|&gt;)/g, \"</span>\");\n                s = s.replace(\n                    /(<|&lt;)arrow(>|&gt;)/g,\n                    \"<span style=text-decoration:overline;>\"\n                );\n                s = s.replace(/(<|&lt;)\\/arrow(>|&gt;)/g, \"</span>\");\n            }\n\n            return s;\n        },\n\n        /**\n         * Converts the sketchometry tag <sketchofont> to\n         * HTML span tags with proper CSS formatting.\n         *\n         * @param {String|Function|Number} s Text\n         * @param {Boolean} escape Flag if ticks should be escaped. Escaping is necessary\n         * if s is a text. It has to be avoided if s is a function returning text.\n         * @private\n         * @see JXG.Text._setText\n         * @see JXG.Text.convertGeonextAndSketchometry2CSS\n         *\n         */\n        convertSketchometry2CSS: function (s, escape) {\n            var t1 = \"<span class=\\\"sketcho sketcho-inherit sketcho-\",\n                t2 = \"\\\"></span>\";\n\n            if (Type.isString(s)) {\n                if (escape) {\n                    t1 = this.escapeTicks(t1);\n                    t2 = this.escapeTicks(t2);\n                }\n                s = s.replace(/(<|&lt;)sketchofont(>|&gt;)/g, t1);\n                s = s.replace(/(<|&lt;)\\/sketchofont(>|&gt;)/g, t2);\n            }\n\n            return s;\n        },\n\n        /**\n         * Alias for convertGeonext2CSS and convertSketchometry2CSS\n         *\n         * @param {String|Function|Number} s Text\n         * @param {Boolean} escape Flag if ticks should be escaped\n         * @private\n         * @see JXG.Text.convertGeonext2CSS\n         * @see JXG.Text.convertSketchometry2CSS\n         */\n        convertGeonextAndSketchometry2CSS: function (s, escape) {\n            s = this.convertGeonext2CSS(s);\n            s = this.convertSketchometry2CSS(s, escape);\n            return s;\n        },\n\n        /**\n         * Finds dependencies in a given term and notifies the parents by adding the\n         * dependent object to the found objects child elements.\n         * @param {String} content String containing dependencies for the given object.\n         * @private\n         */\n        notifyParents: function (content) {\n            var search,\n                res = null;\n\n            // revert possible jc replacement\n            content = content.replace(/&lt;value&gt;/g, \"<value>\");\n            content = content.replace(/&lt;\\/value&gt;/g, \"</value>\");\n\n            do {\n                search = /<value>([\\w\\s*/^\\-+()[\\],<>=!]+)<\\/value>/;\n                res = search.exec(content);\n\n                if (res !== null) {\n                    GeonextParser.findDependencies(this, res[1], this.board);\n                    content = content.slice(res.index);\n                    content = content.replace(search, \"\");\n                }\n            } while (res !== null);\n\n            return this;\n        },\n\n        // documented in element.js\n        getParents: function () {\n            var p;\n            if (this.relativeCoords !== undefined) {\n                // Texts with anchor elements, excluding labels\n                p = [\n                    this.relativeCoords.usrCoords[1],\n                    this.relativeCoords.usrCoords[2],\n                    this.orgText\n                ];\n            } else {\n                // Other texts\n                p = [this.Z(), this.X(), this.Y(), this.orgText];\n            }\n\n            if (this.parents.length !== 0) {\n                p = this.parents;\n            }\n\n            return p;\n        },\n\n        /**\n         * Returns the bounding box of the text element in user coordinates as an\n         * array of length 4: [upper left x, upper left y, lower right x, lower right y].\n         * The method assumes that the lower left corner is at position [el.X(), el.Y()]\n         * of the text element el, i.e. the attributes anchorX, anchorY are ignored.\n         *\n         * <p>\n         * or labels, [0, 0, 0, 0] is returned.\n         *\n         * @returns Array\n         */\n        bounds: function () {\n            var c = this.coords.usrCoords;\n\n            if (\n                Type.evaluate(this.visProp.islabel) ||\n                this.board.unitY === 0 ||\n                this.board.unitX === 0\n            ) {\n                return [0, 0, 0, 0];\n            }\n            return [\n                c[1],\n                c[2] + this.size[1] / this.board.unitY,\n                c[1] + this.size[0] / this.board.unitX,\n                c[2]\n            ];\n        },\n\n        /**\n         * Returns the value of the attribute \"anchorX\". If this equals \"auto\",\n         * returns \"left\", \"middle\", or \"right\", depending on the\n         * value of the attribute \"position\".\n         * @returns String\n         */\n        getAnchorX: function () {\n            var a = Type.evaluate(this.visProp.anchorx);\n            if (a === \"auto\") {\n                switch (this.visProp.position) {\n                    case \"top\":\n                    case \"bot\":\n                        return \"middle\";\n                    case \"rt\":\n                    case \"lrt\":\n                    case \"urt\":\n                        return \"left\";\n                    case \"lft\":\n                    case \"llft\":\n                    case \"ulft\":\n                    default:\n                        return \"right\";\n                }\n            }\n            return a;\n        },\n\n        /**\n         * Returns the value of the attribute \"anchorY\". If this equals \"auto\",\n         * returns \"bottom\", \"middle\", or \"top\", depending on the\n         * value of the attribute \"position\".\n         * @returns String\n         */\n        getAnchorY: function () {\n            var a = Type.evaluate(this.visProp.anchory);\n            if (a === \"auto\") {\n                switch (this.visProp.position) {\n                    case \"top\":\n                    case \"ulft\":\n                    case \"urt\":\n                        return \"bottom\";\n                    case \"bot\":\n                    case \"lrt\":\n                    case \"llft\":\n                        return \"top\";\n                    case \"rt\":\n                    case \"lft\":\n                    default:\n                        return \"middle\";\n                }\n            }\n            return a;\n        },\n\n        /**\n         * Computes the number of overlaps of a box of w pixels width, h pixels height\n         * and center (x, y)\n         *\n         * @private\n         * @param  {Number} x x-coordinate of the center (screen coordinates)\n         * @param  {Number} y y-coordinate of the center (screen coordinates)\n         * @param  {Number} w width of the box in pixel\n         * @param  {Number} h width of the box in pixel\n         * @return {Number}   Number of overlapping elements\n         */\n        getNumberOfConflicts: function (x, y, w, h) {\n            var count = 0,\n                i, obj, le,\n                savePointPrecision;\n\n            // Set the precision of hasPoint to half the max if label isn't too long\n            savePointPrecision = this.board.options.precision.hasPoint;\n            // this.board.options.precision.hasPoint = Math.max(w, h) * 0.5;\n            this.board.options.precision.hasPoint = (w + h) * 0.25;\n            // TODO:\n            // Make it compatible with the objects' visProp.precision attribute\n            for (i = 0, le = this.board.objectsList.length; i < le; i++) {\n                obj = this.board.objectsList[i];\n                if (\n                    obj.visPropCalc.visible &&\n                    obj.elType !== \"axis\" &&\n                    obj.elType !== \"ticks\" &&\n                    obj !== this.board.infobox &&\n                    obj !== this &&\n                    obj.hasPoint(x, y)\n                ) {\n                    count++;\n                }\n            }\n            this.board.options.precision.hasPoint = savePointPrecision;\n\n            return count;\n        },\n\n        /**\n         * Sets the offset of a label element to the position with the least number\n         * of overlaps with other elements, while retaining the distance to its\n         * anchor element. Twelve different angles are possible.\n         *\n         * @returns {JXG.Text} Reference to the text object.\n         */\n        setAutoPosition: function () {\n            var x, y, cx, cy,\n                anchorCoords,\n                // anchorX, anchorY,\n                w = this.size[0],\n                h = this.size[1],\n                start_angle, angle,\n                optimum = {\n                    conflicts: Infinity,\n                    angle: 0,\n                    r: 0\n                },\n                max_r, delta_r,\n                conflicts, offset, r,\n                num_positions = 12,\n                step = (2 * Math.PI) / num_positions,\n                j, dx, dy, co, si;\n\n            if (\n                this === this.board.infobox ||\n                !this.visPropCalc.visible ||\n                !Type.evaluate(this.visProp.islabel) ||\n                !this.element\n            ) {\n                return this;\n            }\n\n            // anchorX = Type.evaluate(this.visProp.anchorx);\n            // anchorY = Type.evaluate(this.visProp.anchory);\n            offset = Type.evaluate(this.visProp.offset);\n            anchorCoords = this.element.getLabelAnchor();\n            cx = anchorCoords.scrCoords[1];\n            cy = anchorCoords.scrCoords[2];\n\n            // Set dx, dy as the relative position of the center of the label\n            // to its anchor element ignoring anchorx and anchory.\n            dx = offset[0];\n            dy = offset[1];\n\n            conflicts = this.getNumberOfConflicts(cx + dx, cy - dy, w, h);\n            if (conflicts === 0) {\n                return this;\n            }\n            // console.log(this.id, conflicts, w, h);\n            // r = Geometry.distance([0, 0], offset, 2);\n\n            r = Type.evaluate(this.visProp.autopositionmindistance);\n            max_r = Type.evaluate(this.visProp.autopositionmaxdistance);\n            delta_r = 0.2 * r;\n\n            start_angle = Math.atan2(dy, dx);\n\n            optimum.conflicts = conflicts;\n            optimum.angle = start_angle;\n            optimum.r = r;\n\n            while (optimum.conflicts > 0 && r <= max_r) {\n                for (\n                    j = 1, angle = start_angle + step;\n                    j < num_positions && optimum.conflicts > 0;\n                    j++\n                ) {\n                    co = Math.cos(angle);\n                    si = Math.sin(angle);\n\n                    x = cx + r * co;\n                    y = cy - r * si;\n\n                    conflicts = this.getNumberOfConflicts(x, y, w, h);\n                    if (conflicts < optimum.conflicts) {\n                        optimum.conflicts = conflicts;\n                        optimum.angle = angle;\n                        optimum.r = r;\n                    }\n                    if (optimum.conflicts === 0) {\n                        break;\n                    }\n                    angle += step;\n                }\n                r += delta_r;\n            }\n            // console.log(this.id, \"after\", optimum)\n            r = optimum.r;\n            co = Math.cos(optimum.angle);\n            si = Math.sin(optimum.angle);\n            this.visProp.offset = [r * co, r * si];\n\n            if (co < -0.2) {\n                this.visProp.anchorx = \"right\";\n            } else if (co > 0.2) {\n                this.visProp.anchorx = \"left\";\n            } else {\n                this.visProp.anchorx = \"middle\";\n            }\n\n            return this;\n        }\n    }\n);\n\n/**\n * @class Construct and handle texts.\n *\n * The coordinates can either be abslute (i.e. respective to the coordinate system of the board) or be relative to the coordinates of an element\n * given in {@link Text#anchor}.\n * <p>\n * HTML, MathJaX, KaTeX and GEONExT syntax can be handled.\n * <p>\n * There are two ways to display texts:\n * <ul>\n * <li> using the text element of the renderer (canvas or svg). In most cases this is the suitable approach if speed matters.\n * However, advanced rendering like MathJax, KaTeX or HTML/CSS are not possible.\n * <li> using HTML &lt;div&gt;. This is the most flexible approach. The drawback is that HTML can only be display \"above\" the geometry elements.\n * If HTML should be displayed in an inbetween layer, conder to use an element of type {@link ForeignObject} (available in svg renderer, only).\n * </ul>\n * @pseudo\n * @name Text\n * @augments JXG.Text\n * @constructor\n * @type JXG.Text\n *\n * @param {number,function_number,function_number,function_String,function} z_,x,y,str Parent elements for text elements.\n *                     <p>\n *   Parent elements can be two or three elements of type number, a string containing a GEONE<sub>x</sub>T\n *   constraint, or a function which takes no parameter and returns a number. Every parent element beside the last determines one coordinate.\n *   If a coordinate is\n *   given by a number, the number determines the initial position of a free text. If given by a string or a function that coordinate will be constrained\n *   that means the user won't be able to change the texts's position directly by mouse because it will be calculated automatically depending on the string\n *   or the function's return value. If two parent elements are given the coordinates will be interpreted as 2D affine Euclidean coordinates, if three such\n *   parent elements are given they will be interpreted as homogeneous coordinates.\n *                     <p>\n *                     The text to display may be given as string or as function returning a string.\n *\n * There is the attribute 'display' which takes the values 'html' or 'internal'. In case of 'html' an HTML division tag is created to display\n * the text. In this case it is also possible to use MathJax, KaTeX, or ASCIIMathML. If neither of these is used, basic Math rendering is\n * applied.\n * <p>\n * In case of 'internal', an SVG text element is used to display the text.\n * @see JXG.Text\n * @example\n * // Create a fixed text at position [0,1].\n *   var t1 = board.create('text',[0,1,\"Hello World\"]);\n * </pre><div class=\"jxgbox\" id=\"JXG896013aa-f24e-4e83-ad50-7bc7df23f6b7\" style=\"width: 300px; height: 300px;\"></div>\n * <script type=\"text/javascript\">\n *   var t1_board = JXG.JSXGraph.initBoard('JXG896013aa-f24e-4e83-ad50-7bc7df23f6b7', {boundingbox: [-3, 6, 5, -3], axis: true, showcopyright: false, shownavigation: false});\n *   var t1 = t1_board.create('text',[0,1,\"Hello World\"]);\n * </script><pre>\n * @example\n * // Create a variable text at a variable position.\n *   var s = board.create('slider',[[0,4],[3,4],[-2,0,2]]);\n *   var graph = board.create('text',\n *                        [function(x){ return s.Value();}, 1,\n *                         function(){return \"The value of s is\"+JXG.toFixed(s.Value(), 2);}\n *                        ]\n *                     );\n * </pre><div class=\"jxgbox\" id=\"JXG5441da79-a48d-48e8-9e53-75594c384a1c\" style=\"width: 300px; height: 300px;\"></div>\n * <script type=\"text/javascript\">\n *   var t2_board = JXG.JSXGraph.initBoard('JXG5441da79-a48d-48e8-9e53-75594c384a1c', {boundingbox: [-3, 6, 5, -3], axis: true, showcopyright: false, shownavigation: false});\n *   var s = t2_board.create('slider',[[0,4],[3,4],[-2,0,2]]);\n *   var t2 = t2_board.create('text',[function(x){ return s.Value();}, 1, function(){return \"The value of s is \"+JXG.toFixed(s.Value(), 2);}]);\n * </script><pre>\n * @example\n * // Create a text bound to the point A\n * var p = board.create('point',[0, 1]),\n *     t = board.create('text',[0, -1,\"Hello World\"], {anchor: p});\n *\n * </pre><div class=\"jxgbox\" id=\"JXGff5a64b2-2b9a-11e5-8dd9-901b0e1b8723\" style=\"width: 300px; height: 300px;\"></div>\n * <script type=\"text/javascript\">\n *     (function() {\n *         var board = JXG.JSXGraph.initBoard('JXGff5a64b2-2b9a-11e5-8dd9-901b0e1b8723',\n *             {boundingbox: [-8, 8, 8,-8], axis: true, showcopyright: false, shownavigation: false});\n *     var p = board.create('point',[0, 1]),\n *         t = board.create('text',[0, -1,\"Hello World\"], {anchor: p});\n *\n *     })();\n *\n * </script><pre>\n *\n */\nJXG.createText = function (board, parents, attributes) {\n    var t,\n        attr = Type.copyAttributes(attributes, board.options, \"text\"),\n        coords = parents.slice(0, -1),\n        content = parents[parents.length - 1];\n\n    // downwards compatibility\n    attr.anchor = attr.parent || attr.anchor;\n    t = CoordsElement.create(JXG.Text, board, coords, attr, content);\n\n    if (!t) {\n        throw new Error(\n            \"JSXGraph: Can't create text with parent types '\" +\n                typeof parents[0] +\n                \"' and '\" +\n                typeof parents[1] +\n                \"'.\" +\n                \"\\nPossible parent types: [x,y], [z,x,y], [element,transformation]\"\n        );\n    }\n\n    if (attr.rotate !== 0) {\n        // This is the default value, i.e. no rotation\n        t.addRotation(attr.rotate);\n    }\n\n    return t;\n};\n\nJXG.registerElement(\"text\", JXG.createText);\n\n/**\n * @class Labels are text objects tied to other elements like points, lines and curves.\n * Labels are handled internally by JSXGraph, only. There is NO constructor \"board.create('label', ...)\".\n *\n * @pseudo\n * @name Label\n * @augments JXG.Text\n * @constructor\n * @type JXG.Text\n */\n//  See element.js#createLabel\n\n/**\n * [[x,y], [w px, h px], [range]\n */\nJXG.createHTMLSlider = function (board, parents, attributes) {\n    var t,\n        par,\n        attr = Type.copyAttributes(attributes, board.options, \"htmlslider\");\n\n    if (parents.length !== 2 || parents[0].length !== 2 || parents[1].length !== 3) {\n        throw new Error(\n            \"JSXGraph: Can't create htmlslider with parent types '\" +\n                typeof parents[0] +\n                \"' and '\" +\n                typeof parents[1] +\n                \"'.\" +\n                \"\\nPossible parents are: [[x,y], [min, start, max]]\"\n        );\n    }\n\n    // backwards compatibility\n    attr.anchor = attr.parent || attr.anchor;\n    attr.fixed = attr.fixed || true;\n\n    par = [\n        parents[0][0],\n        parents[0][1],\n        '<form style=\"display:inline\">' +\n            '<input type=\"range\" /><span></span><input type=\"text\" />' +\n            \"</form>\"\n    ];\n\n    t = JXG.createText(board, par, attr);\n    t.type = Type.OBJECT_TYPE_HTMLSLIDER;\n\n    t.rendNodeForm = t.rendNode.childNodes[0];\n\n    t.rendNodeRange = t.rendNodeForm.childNodes[0];\n    t.rendNodeRange.min = parents[1][0];\n    t.rendNodeRange.max = parents[1][2];\n    t.rendNodeRange.step = attr.step;\n    t.rendNodeRange.value = parents[1][1];\n\n    t.rendNodeLabel = t.rendNodeForm.childNodes[1];\n    t.rendNodeLabel.id = t.rendNode.id + \"_label\";\n\n    if (attr.withlabel) {\n        t.rendNodeLabel.innerHTML = t.name + \"=\";\n    }\n\n    t.rendNodeOut = t.rendNodeForm.childNodes[2];\n    t.rendNodeOut.value = parents[1][1];\n\n    try {\n        t.rendNodeForm.id = t.rendNode.id + \"_form\";\n        t.rendNodeRange.id = t.rendNode.id + \"_range\";\n        t.rendNodeOut.id = t.rendNode.id + \"_out\";\n    } catch (e) {\n        JXG.debug(e);\n    }\n\n    t.rendNodeRange.style.width = attr.widthrange + \"px\";\n    t.rendNodeRange.style.verticalAlign = \"middle\";\n    t.rendNodeOut.style.width = attr.widthout + \"px\";\n\n    t._val = parents[1][1];\n\n    if (JXG.supportsVML()) {\n        /*\n         * OnChange event is used for IE browsers\n         * The range element is supported since IE10\n         */\n        Env.addEvent(t.rendNodeForm, \"change\", priv.HTMLSliderInputEventHandler, t);\n    } else {\n        /*\n         * OnInput event is used for non-IE browsers\n         */\n        Env.addEvent(t.rendNodeForm, \"input\", priv.HTMLSliderInputEventHandler, t);\n    }\n\n    t.Value = function () {\n        return this._val;\n    };\n\n    return t;\n};\n\nJXG.registerElement(\"htmlslider\", JXG.createHTMLSlider);\n\nexport default JXG.Text;\n// export default {\n//     Text: JXG.Text,\n//     createText: JXG.createText,\n//     createHTMLSlider: JXG.createHTMLSlider\n// };\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,OAAOA,GAAG,MAAM,QAAQ;AACxB,OAAOC,KAAK,MAAM,aAAa;AAC/B,OAAOC,eAAe,MAAM,WAAW;AACvC,OAAOC,aAAa,MAAM,mBAAmB;AAC7C,OAAOC,GAAG,MAAM,cAAc;AAC9B,OAAOC,IAAI,MAAM,eAAe;AAChC,OAAOC,GAAG,MAAM,cAAc;AAC9B,OAAOC,aAAa,MAAM,iBAAiB;AAE3C,IAAIC,IAAI,GAAG;EACP;AACJ;AACA;AACA;EACIC,2BAA2B,EAAE,SAAAA,CAAA,EAAY;IACrC,IAAI,CAACC,IAAI,GAAGC,UAAU,CAAC,IAAI,CAACC,aAAa,CAACC,KAAK,CAAC;IAChD,IAAI,CAACC,WAAW,CAACD,KAAK,GAAG,IAAI,CAACD,aAAa,CAACC,KAAK;IACjD,IAAI,CAACE,KAAK,CAACC,MAAM,CAAC,CAAC;EACvB;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAhB,GAAG,CAACiB,IAAI,GAAG,UAAUF,KAAK,EAAEG,MAAM,EAAEC,UAAU,EAAEC,OAAO,EAAE;EACrD,IAAIC,GAAG;EAEP,IAAI,CAACC,WAAW,CAACP,KAAK,EAAEI,UAAU,EAAElB,KAAK,CAACsB,gBAAgB,EAAEtB,KAAK,CAACuB,iBAAiB,CAAC;EAEpF,IAAI,CAACC,OAAO,GAAG,IAAI,CAACV,KAAK,CAACW,MAAM,CAACP,UAAU,CAACQ,MAAM,CAAC;EACnD,IAAI,CAACC,iBAAiB,CAACV,MAAM,EAAEb,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACC,OAAO,CAAC,CAAC;EAEnE,IAAI,CAACX,OAAO,GAAG,EAAE;EACjB,IAAI,CAACY,SAAS,GAAG,EAAE;EACnB,IAAI,CAACC,YAAY,GAAG,IAAI;EACxB,IAAI,CAACC,OAAO,GAAG,EAAE;EAEjB,IAAI,CAACC,eAAe,GAAG,KAAK;EAC5B;EACA,IAAI,CAACC,cAAc,GAAG,KAAK;;EAE3B;AACJ;AACA;AACA;AACA;AACA;EACI,IAAI,CAACC,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC;EACtB,IAAI,CAACC,EAAE,GAAG,IAAI,CAACvB,KAAK,CAACwB,KAAK,CAAC,IAAI,EAAE,GAAG,CAAC;EAErC,IAAI,CAACxB,KAAK,CAACyB,QAAQ,CAACC,QAAQ,CAAC,IAAI,CAAC;EAClC,IAAI,CAAC1B,KAAK,CAAC2B,cAAc,CAAC,IAAI,CAAC;;EAE/B;EACA;EACA;;EAEA;EACA;EACArB,GAAG,GAAG,IAAI,CAACS,OAAO,CAACa,OAAO;EAC1B,IAAI,CAACb,OAAO,CAACa,OAAO,GAAG,IAAI;EAC3B,IAAI,CAACC,OAAO,CAACxB,OAAO,CAAC;EACrB;EACA,IAAI,CAACU,OAAO,CAACa,OAAO,GAAGtB,GAAG;EAE1B,IAAIhB,IAAI,CAACwC,QAAQ,CAAC,IAAI,CAACzB,OAAO,CAAC,EAAE;IAC7B,IAAI,CAAC0B,aAAa,CAAC,IAAI,CAAC1B,OAAO,CAAC;EACpC;EACA,IAAI,CAAC2B,MAAM,GAAG,MAAM;EAEpB,IAAI,CAACC,SAAS,GAAG3C,IAAI,CAAC4C,QAAQ,CAAC,IAAI,CAACD,SAAS,EAAE;IAC3CJ,OAAO,EAAE;IACT;IACA;EACJ,CAAC,CAAC;AACN,CAAC;AAED5C,GAAG,CAACiB,IAAI,CAACiC,SAAS,GAAG,IAAIhD,eAAe,CAAC,CAAC;AAC1CG,IAAI,CAAC8C,oBAAoB,CAACnD,GAAG,CAACiB,IAAI,EAAEV,aAAa,EAAE,mBAAmB,CAAC;AAEvEP,GAAG,CAACoD,MAAM,CACNpD,GAAG,CAACiB,IAAI,CAACiC,SAAS,EAClB,gCAAiC;EAC7B;AACR;AACA;AACA;AACA;AACA;EACQ;EACA;EACA;EACA;EACA;EACAG,QAAQ,EAAE,SAAAA,CAAUC,CAAC,EAAEC,CAAC,EAAE;IACtB,IAAIC,GAAG,EAAEC,EAAE,EAAEC,GAAG,EAAEC,GAAG,EAAEC,EAAE,EAAEC,EAAE,EAAEC,IAAI,EAAEC,CAAC;IAEtC,IAAI1D,IAAI,CAAC2D,QAAQ,CAAC3D,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACmC,SAAS,CAAC,CAAC,EAAE;MACtDH,IAAI,GAAG,IAAI,CAAC/C,KAAK,CAACmD,YAAY;MAC9BH,CAAC,GAAG1D,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACmC,SAAS,CAACH,IAAI,CAAC,CAAC;IACnD,CAAC,MAAM;MACH;MACAC,CAAC,GAAG,IAAI,CAAChD,KAAK,CAACoD,OAAO,CAACF,SAAS,CAACZ,QAAQ;IAC7C;IACA,IAAI,IAAI,CAACe,eAAe,CAACC,MAAM,GAAG,CAAC,EAAE;MACjC;MACA;MACAb,GAAG,GAAGlD,GAAG,CAACgE,UAAU,CAChBhE,GAAG,CAACiE,OAAO,CAAC,IAAI,CAACxD,KAAK,CAACyB,QAAQ,CAACgC,cAAc,CAAC,IAAI,EAAE,IAAI,CAACJ,eAAe,CAAC,CAAC,EAC3E,CAAC,CAAC,EAAEd,CAAC,EAAEC,CAAC,CACZ,CAAC;MACDD,CAAC,GAAGE,GAAG,CAAC,CAAC,CAAC;MACVD,CAAC,GAAGC,GAAG,CAAC,CAAC,CAAC;IACd;IAEAI,EAAE,GAAG,IAAI,CAACa,UAAU,CAAC,CAAC;IACtB,IAAIb,EAAE,KAAK,OAAO,EAAE;MAChBJ,GAAG,GAAG,IAAI,CAACtC,MAAM,CAACwD,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC;IACjD,CAAC,MAAM,IAAIuB,EAAE,KAAK,QAAQ,EAAE;MACxBJ,GAAG,GAAG,IAAI,CAACtC,MAAM,CAACwD,SAAS,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC;IACvD,CAAC,MAAM;MACHmB,GAAG,GAAG,IAAI,CAACtC,MAAM,CAACwD,SAAS,CAAC,CAAC,CAAC;IAClC;IACAjB,EAAE,GAAGD,GAAG,GAAG,IAAI,CAACnB,IAAI,CAAC,CAAC,CAAC;IAEvBwB,EAAE,GAAG,IAAI,CAACc,UAAU,CAAC,CAAC;IACtB,IAAId,EAAE,KAAK,KAAK,EAAE;MACdF,GAAG,GAAG,IAAI,CAACzC,MAAM,CAACwD,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC;IACjD,CAAC,MAAM,IAAIwB,EAAE,KAAK,QAAQ,EAAE;MACxBF,GAAG,GAAG,IAAI,CAACzC,MAAM,CAACwD,SAAS,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC;IACvD,CAAC,MAAM;MACHsB,GAAG,GAAG,IAAI,CAACzC,MAAM,CAACwD,SAAS,CAAC,CAAC,CAAC;IAClC;IACAhB,GAAG,GAAGC,GAAG,GAAG,IAAI,CAACtB,IAAI,CAAC,CAAC,CAAC;IAExB,IAAIhC,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC8C,QAAQ,CAAC,KAAK,KAAK,EAAE;MAChD,OAAOtB,CAAC,IAAIE,GAAG,GAAGO,CAAC,IAAIT,CAAC,GAAGG,EAAE,GAAGM,CAAC,IAAIR,CAAC,IAAIG,GAAG,GAAGK,CAAC,IAAIR,CAAC,IAAII,GAAG,GAAGI,CAAC;IACrE;IACA;IACA,OACIR,CAAC,IAAIG,GAAG,GAAGK,CAAC,IACZR,CAAC,IAAII,GAAG,GAAGI,CAAC,KACVT,CAAC,IAAIE,GAAG,GAAGO,CAAC,IAAIT,CAAC,IAAIE,GAAG,GAAG,CAAC,GAAGO,CAAC,IAAMT,CAAC,IAAIG,EAAE,GAAG,CAAC,GAAGM,CAAC,IAAIT,CAAC,IAAIG,EAAE,GAAGM,CAAE,CAAC;EAEhF,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;EACQc,oBAAoB,EAAE,SAAAA,CAAUC,IAAI,EAAE;IAClC,IAAIC,UAAU;MAAEC,CAAC;MAAEC,MAAM;MACrBC,YAAY;MACZC,CAAC;MAAEC,IAAI;MACPC,IAAI,GAAGhF,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACwD,KAAK,CAAC;MACxCC,KAAK,GAAGlF,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC0D,UAAU,CAAC;MAC9CC,KAAK,GAAGpF,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC4D,QAAQ,CAAC;MAC5CC,iBAAiB,GAAG,KAAK;IAE7B,IAAI,CAACzD,OAAO,GAAG4C,IAAI;IAEnB,IAAIzE,IAAI,CAACuF,UAAU,CAACd,IAAI,CAAC,EAAE;MACvB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACgB,IAAI,CAACC,UAAU,GAAG,YAAY;QAC1BG,YAAY,GAAGJ,IAAI,CAAC,CAAC,CAACe,QAAQ,CAAC,CAAC,CAAC,CAAC;QAClC,IAAIR,IAAI,IAAI,CAACE,KAAK,IAAI,CAACE,KAAK,EAAE;UAC1B,IAAI,CAACzD,SAAS,GAAG,IAAI,CAAC8D,UAAU,CAC5B,IAAI,CAACC,UAAU,CACX,IAAI,CAACC,iCAAiC,CAACd,YAAY,EAAE,KAAK,CAC9D,CACJ,CAAC;QACL,CAAC,MAAM;UACH,IAAI,CAAClD,SAAS,GAAGkD,YAAY;QACjC;MACJ,CAAC;IACL,CAAC,MAAM;MACH,IAAI7E,IAAI,CAAC4F,QAAQ,CAACnB,IAAI,CAAC,EAAE;QACrBG,MAAM,GAAG5E,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACmD,MAAM,CAAC;QAC3C,IAAI,IAAI,CAACiB,SAAS,CAAC,CAAC,EAAE;UAClB,IAAI,CAAC9E,OAAO,GAAG,IAAI,CAAC+E,kBAAkB,CAACrB,IAAI,EAAEG,MAAM,CAAC;QACxD,CAAC,MAAM;UACH,IAAI,CAAC7D,OAAO,GAAGf,IAAI,CAAC+F,OAAO,CAACtB,IAAI,EAAEG,MAAM,CAAC;QAC7C;MACJ,CAAC,MAAM,IAAI5E,IAAI,CAACwC,QAAQ,CAACiC,IAAI,CAAC,IAAIO,IAAI,EAAE;QACpC,IAAIhF,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACuE,cAAc,CAAC,EAAE;UAC5C;UACA;UACA,IAAI,CAACjF,OAAO,GAAG,IAAI,GAAG0D,IAAI,GAAG,IAAI;QACrC,CAAC,MAAM,IAAIS,KAAK,IAAIE,KAAK,EAAE;UACvB;UACA;UACA;UACA,IAAI,CAACrE,OAAO,GAAG,IAAI,CAACkF,oBAAoB,CAACxB,IAAI,CAAC;UAC9C,IAAI,CAACzE,IAAI,CAACkG,OAAO,CAAC,IAAI,CAACnF,OAAO,CAAC,EAAE;YAC7B;YACA;YACA;YACA;YACA;YACA;YACA;YACA,IAAI,CAACA,OAAO,GAAG,IAAI,CAACA,OAAO,CAACoF,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;UACxD;QACJ,CAAC,MAAM;UACH;UACA;UACA;UACA;UACA;UACA,IAAI,CAACpF,OAAO,GAAG,IAAI,CAACqF,WAAW,CAAC,IAAI,CAACH,oBAAoB,CAACxB,IAAI,CAAC,CAAC;QACpE;QACAa,iBAAiB,GAAG,IAAI;MAC5B,CAAC,MAAM;QACH,IAAI,CAACvE,OAAO,GAAG0D,IAAI;MACvB;;MAEA;MACA,IAAIa,iBAAiB,EAAE;QACnB;QACA,IAAItF,IAAI,CAACkG,OAAO,CAAC,IAAI,CAACnF,OAAO,CAAC,EAAE;UAC5B;UACA;UACA;UACAgE,IAAI,GAAG,IAAI;UACX,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC/D,OAAO,CAACiD,MAAM,EAAEc,CAAC,EAAE,EAAE;YACtC,IAAI,IAAI,CAAC/D,OAAO,CAAC+D,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;cAC5B,IAAI,CAAC/D,OAAO,CAAC+D,CAAC,CAAC,GAAG,IAAI,CAACpE,KAAK,CAAC2F,EAAE,CAACC,OAAO,CAAC,IAAI,CAACvF,OAAO,CAAC+D,CAAC,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,CAAC;cACzE,KAAKH,CAAC,IAAI,IAAI,CAAC5D,OAAO,CAAC+D,CAAC,CAAC,CAACyB,IAAI,EAAE;gBAC5B,IAAI,CAACC,UAAU,CAAC,IAAI,CAACzF,OAAO,CAAC+D,CAAC,CAAC,CAACyB,IAAI,CAAC5B,CAAC,CAAC,CAAC;gBACxC,IAAI,CAAC5D,OAAO,CAAC+D,CAAC,CAAC,CAACyB,IAAI,CAAC5B,CAAC,CAAC,CAAC8B,QAAQ,CAAC,IAAI,CAAC;cAC1C;YACJ;UACJ;UAEA/B,UAAU,GAAG,SAAAA,CAAA,EAAW;YACpB,IAAII,CAAC;cAAE4B,CAAC;cACJ9B,MAAM,GAAG5E,IAAI,CAACwB,QAAQ,CAACuD,IAAI,CAACtD,OAAO,CAACmD,MAAM,CAAC;cAC3C+B,GAAG,GAAG,EAAE;YAEZ,KAAK7B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,IAAI,CAAChE,OAAO,CAACiD,MAAM,EAAEc,CAAC,EAAE,EAAE;cACtC,IAAI9E,IAAI,CAACuF,UAAU,CAACR,IAAI,CAAChE,OAAO,CAAC+D,CAAC,CAAC,CAAC,EAAE;gBAClC4B,CAAC,GAAG3B,IAAI,CAAChE,OAAO,CAAC+D,CAAC,CAAC,CAAC,CAAC;gBACrB,IAAIC,IAAI,CAACc,SAAS,CAAC,CAAC,EAAE;kBAClBa,CAAC,GAAG3B,IAAI,CAACe,kBAAkB,CAACY,CAAC,EAAE9B,MAAM,CAAC;gBAC1C,CAAC,MAAM;kBACH8B,CAAC,GAAG1G,IAAI,CAAC+F,OAAO,CAACW,CAAC,EAAE9B,MAAM,CAAC;gBAC/B;cACJ,CAAC,MAAM;gBACH8B,CAAC,GAAG3B,IAAI,CAAChE,OAAO,CAAC+D,CAAC,CAAC;gBACnB,IAAI4B,CAAC,CAACE,EAAE,CAAC,CAAC,CAAC,KAAK,GAAG,IAAIF,CAAC,CAACE,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;kBACrCF,CAAC,GAAGA,CAAC,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtB;cACJ;cAEAF,GAAG,IAAID,CAAC;YACZ;YACA,OAAOC,GAAG;UACd,CAAC;QACL,CAAC,MAAM;UACHjC,UAAU,GAAG,IAAI,CAAChE,KAAK,CAAC2F,EAAE,CAACC,OAAO,CAAC,IAAI,CAACvF,OAAO,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,CAAC;UACjE,KAAK4D,CAAC,IAAID,UAAU,CAAC6B,IAAI,EAAE;YACvB,IAAI,CAACC,UAAU,CAAC9B,UAAU,CAAC6B,IAAI,CAAC5B,CAAC,CAAC,CAAC;YACnCD,UAAU,CAAC6B,IAAI,CAAC5B,CAAC,CAAC,CAAC8B,QAAQ,CAAC,IAAI,CAAC;UACrC;QACJ;;QAEA;QACA,IAAI,CAAC/B,UAAU,GAAG,YAAY;UAC1B,IAAI,CAAC/C,SAAS,GAAG,IAAI,CAACmF,aAAa,CAACpC,UAAU,CAAC,CAAC,CAAC;QACrD,CAAC;MACL,CAAC,MAAM;QACH,IAAI,CAACA,UAAU,GAAG,YAAY;UAC1B,IAAI,CAAC/C,SAAS,GAAG,IAAI,CAACZ,OAAO,CAAC,CAAC;QACnC,CAAC;MACL;IACJ;EACJ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;EACQgG,QAAQ,EAAE,SAAAA,CAAUtC,IAAI,EAAE;IACtB,IAAI,CAACD,oBAAoB,CAACC,IAAI,CAAC;;IAE/B;IACA;IACA,IAAI,CAACC,UAAU,CAAC,CAAC;IACjB,IAAI,CAACsC,UAAU,CAAC,CAAC;;IAEjB;IACA,IAAI,CAAC,IAAI,CAACtG,KAAK,CAACuG,OAAO,IAAI,IAAI,CAAChF,EAAE,KAAK,IAAI,CAACvB,KAAK,CAACuG,OAAO,CAAChF,EAAE,EAAE;MAC1D,IAAI,CAACiF,UAAU,CAAC,CAAC,CAAC,CAAC;IACvB;;IAEA;IACA;IACA;IACA;;IAEA,OAAO,IAAI;EACf,CAAC;EAED;AACR;AACA;AACA;EACQC,iBAAiB,EAAE,SAAAA,CAAU1C,IAAI,EAAE;IAC/B,IAAI2C,CAAC;IAEL,IAAI,CAAC3F,OAAO,CAAC4F,OAAO,GAAG5C,IAAI;IAC3B,IAAIzE,IAAI,CAACuF,UAAU,CAACd,IAAI,CAAC,EAAE;MACvB2C,CAAC,GAAG,SAAAA,CAAA,EAAY;QACZ,OAAOpH,IAAI,CAACsH,YAAY,CAAC7C,IAAI,CAAC,CAAC,CAAC;MACpC,CAAC;IACL,CAAC,MAAM;MACH,IAAIzE,IAAI,CAAC4F,QAAQ,CAACnB,IAAI,CAAC,EAAE;QACrB2C,CAAC,GAAG3C,IAAI;MACZ,CAAC,MAAM;QACH2C,CAAC,GAAGpH,IAAI,CAACsH,YAAY,CAAC7C,IAAI,CAAC;MAC/B;IACJ;IAEA,OAAO,IAAI,CAACsC,QAAQ,CAACK,CAAC,CAAC;EAC3B,CAAC;EAED;AACR;AACA;AACA;AACA;EACQ7E,OAAO,EAAE,SAAAA,CAAUkC,IAAI,EAAE;IACrB,OAAO,IAAI,CAACsC,QAAQ,CAACtC,IAAI,CAAC;EAC9B,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQyC,UAAU,EAAE,SAAAA,CAAA,EAAY;IACpB,IAAIlG,GAAG;MACH+D,IAAI;MACJwC,IAAI;MACJC,IAAI,GAAGxH,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACgG,OAAO,CAAC;IAE9C,IAAI,CAAC1H,GAAG,CAAC2H,SAAS,IAAI,IAAI,CAAChH,KAAK,CAACyB,QAAQ,CAACsB,IAAI,KAAK,IAAI,EAAE;MACrD,OAAO,IAAI;IACf;IACA8D,IAAI,GAAG,IAAI,CAACI,QAAQ;;IAEpB;AACZ;AACA;IACY,IAAIH,IAAI,KAAK,MAAM,IAAI,IAAI,CAAC9G,KAAK,CAACyB,QAAQ,CAACsB,IAAI,KAAK,KAAK,EAAE;MACvD,IAAIzD,IAAI,CAAC4H,MAAM,CAACL,IAAI,CAACM,WAAW,CAAC,EAAE;QAC/B9C,IAAI,GAAG,IAAI;QACX+C,MAAM,CAACC,UAAU,CAAC,YAAY;UAC1BhD,IAAI,CAAC/C,IAAI,GAAG,CAACuF,IAAI,CAACM,WAAW,EAAEN,IAAI,CAACS,YAAY,CAAC;UACjDjD,IAAI,CAACkD,WAAW,GAAG,IAAI;UACvBlD,IAAI,CAACmD,cAAc,CAAC,CAAC;QACzB,CAAC,EAAE,CAAC,CAAC;QACL;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACJ,CAAC,MAAM;QACH,IAAI,CAAClG,IAAI,GAAG,IAAI,CAACmG,iBAAiB,CAAC,CAAC;MACxC;IACJ,CAAC,MAAM,IAAIX,IAAI,KAAK,UAAU,EAAE;MAC5B,IAAI,IAAI,CAAC9G,KAAK,CAACyB,QAAQ,CAACsB,IAAI,KAAK,KAAK,EAAE;QACpCsB,IAAI,GAAG,IAAI;QACX+C,MAAM,CAACC,UAAU,CAAC,YAAY;UAC1B,IAAI;YACA/G,GAAG,GAAGuG,IAAI,CAACa,OAAO,CAAC,CAAC;YACpBrD,IAAI,CAAC/C,IAAI,GAAG,CAAChB,GAAG,CAACqH,KAAK,EAAErH,GAAG,CAACsH,MAAM,CAAC;YACnCvD,IAAI,CAACkD,WAAW,GAAG,IAAI;YACvBlD,IAAI,CAACmD,cAAc,CAAC,CAAC;UACzB,CAAC,CAAC,OAAOvD,CAAC,EAAE,CAAC;QACjB,CAAC,EAAE,CAAC,CAAC;MACT,CAAC,MAAM,IAAI,IAAI,CAACjE,KAAK,CAACyB,QAAQ,CAACsB,IAAI,KAAK,QAAQ,EAAE;QAC9C,IAAI,CAACzB,IAAI,GAAG,IAAI,CAACmG,iBAAiB,CAAC,CAAC;MACxC;IACJ;IAEA,OAAO,IAAI;EACf,CAAC;EAED;AACR;AACA;AACA;EACQA,iBAAiB,EAAE,SAAAA,CAAA,EAAY;IAC3B,IAAII,KAAK,GAAGjI,UAAU,CAACN,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC+G,QAAQ,CAAC,CAAC;IAC5D,OAAO,CAACD,KAAK,GAAG,IAAI,CAAC5G,SAAS,CAACqC,MAAM,GAAG,IAAI,EAAEuE,KAAK,GAAG,GAAG,CAAC;EAC9D,CAAC;EAED;AACR;AACA;AACA;AACA;EACQE,WAAW,EAAE,SAAAA,CAAUC,MAAM,EAAE;IAC3B,OAAOA,MAAM,CAACvC,OAAO,CAAC,YAAY,EAAE,UAAUwC,CAAC,EAAEC,EAAE,EAAE;MACjD,OAAOC,MAAM,CAACC,YAAY,CAACC,QAAQ,CAACH,EAAE,EAAE,EAAE,CAAC,CAAC;IAChD,CAAC,CAAC;EACN,CAAC;EAED;AACR;AACA;AACA;AACA;EACQnD,UAAU,EAAE,SAAAA,CAAUuD,EAAE,EAAE;IACtB,IAAI,CAACA,EAAE,CAACC,OAAO,EAAE;MACb,OAAOD,EAAE;IACb;IAEA,IAAIE,CAAC;MACDpE,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,IAAI,CAAC;;IAExB;IACA;IACA;IACA,OAAOnE,CAAC,IAAI,CAAC,EAAE;MACXkE,EAAE,GAAGA,EAAE,CAACnC,KAAK,CAAC,CAAC,EAAE/B,CAAC,CAAC,GAAGkE,EAAE,CAACnC,KAAK,CAAC/B,CAAC,CAAC,CAACqB,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC;MACzD+C,CAAC,GAAGF,EAAE,CAACC,OAAO,CAAC,GAAG,EAAEnE,CAAC,GAAG,CAAC,CAAC;MAC1B,IAAIoE,CAAC,IAAI,CAAC,EAAE;QACRF,EAAE,GAAGA,EAAE,CAACnC,KAAK,CAAC,CAAC,EAAEqC,CAAC,CAAC,GAAGF,EAAE,CAACnC,KAAK,CAACqC,CAAC,CAAC,CAAC/C,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;MAC7D;MACArB,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,IAAI,CAAC;IACxB;IAEAnE,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,GAAG,CAAC;IACnB,OAAOnE,CAAC,IAAI,CAAC,EAAE;MACXkE,EAAE,GAAGA,EAAE,CAACnC,KAAK,CAAC,CAAC,EAAE/B,CAAC,CAAC,GAAGkE,EAAE,CAACnC,KAAK,CAAC/B,CAAC,CAAC,CAACqB,OAAO,CAAC,OAAO,EAAE,eAAe,CAAC;MACnErB,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,GAAG,CAAC;IACvB;IAEA,OAAOD,EAAE;EACb,CAAC;EAED;AACR;AACA;AACA;AACA;EACQtD,UAAU,EAAE,SAAAA,CAAUsD,EAAE,EAAE;IACtB,IAAI,CAACA,EAAE,CAACC,OAAO,EAAE;MACb,OAAOD,EAAE;IACb;IAEA,IAAIE,CAAC;MACDpE,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,IAAI,CAAC;;IAExB;IACA;IACA;IACA,OAAOnE,CAAC,IAAI,CAAC,EAAE;MACXkE,EAAE,GAAGA,EAAE,CAACnC,KAAK,CAAC,CAAC,EAAE/B,CAAC,CAAC,GAAGkE,EAAE,CAACnC,KAAK,CAAC/B,CAAC,CAAC,CAACqB,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC;MAC1D+C,CAAC,GAAGF,EAAE,CAACC,OAAO,CAAC,GAAG,EAAEnE,CAAC,GAAG,CAAC,CAAC;MAC1B,IAAIoE,CAAC,IAAI,CAAC,EAAE;QACRF,EAAE,GAAGA,EAAE,CAACnC,KAAK,CAAC,CAAC,EAAEqC,CAAC,CAAC,GAAGF,EAAE,CAACnC,KAAK,CAACqC,CAAC,CAAC,CAAC/C,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;MAC7D;MACArB,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,IAAI,CAAC;IACxB;IAEAnE,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,GAAG,CAAC;IACnB,OAAOnE,CAAC,IAAI,CAAC,EAAE;MACXkE,EAAE,GAAGA,EAAE,CAACnC,KAAK,CAAC,CAAC,EAAE/B,CAAC,CAAC,GAAGkE,EAAE,CAACnC,KAAK,CAAC/B,CAAC,CAAC,CAACqB,OAAO,CAAC,QAAQ,EAAE,eAAe,CAAC;MACpErB,CAAC,GAAGkE,EAAE,CAACC,OAAO,CAAC,GAAG,CAAC;IACvB;IAEA,OAAOD,EAAE;EACb,CAAC;EAED;AACR;AACA;AACA;EACQG,OAAO,EAAE,SAAAA,CAAA,EAAY;IACjB,OAAO,IAAI,CAACnH,IAAI;EACpB,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;EACQoH,SAAS,EAAE,SAAAA,CAAUnG,CAAC,EAAEC,CAAC,EAAE;IACvB,IAAImG,YAAY,EAAEC,EAAE,EAAEC,EAAE;IACxB,IAAIvJ,IAAI,CAACkG,OAAO,CAACjD,CAAC,CAAC,IAAIA,CAAC,CAACe,MAAM,GAAG,CAAC,EAAE;MACjCd,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC;MACRA,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;IACZ;IAEA,IAAIjD,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACC,OAAO,CAAC,IAAI1B,IAAI,CAAC4H,MAAM,CAAC,IAAI,CAACxG,OAAO,CAAC,EAAE;MAClEiI,YAAY,GAAG,IAAI,CAACjI,OAAO,CAACoI,cAAc,CAAC,CAAC;MAC5CF,EAAE,GAAG,CAACrG,CAAC,GAAGoG,YAAY,CAACI,SAAS,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC/I,KAAK,CAACgJ,KAAK;MACvDH,EAAE,GAAG,EAAErG,CAAC,GAAGmG,YAAY,CAACI,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC/I,KAAK,CAACiJ,KAAK;MAExD,IAAI,CAACC,cAAc,CAACC,cAAc,CAACjK,KAAK,CAACkK,gBAAgB,EAAE,CAACR,EAAE,EAAEC,EAAE,CAAC,CAAC;IACxE,CAAC,MAAM;MACH;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;MAEgB,IAAI,CAAC1I,MAAM,CAACgJ,cAAc,CAACjK,KAAK,CAACmK,cAAc,EAAE,CAAC9G,CAAC,EAAEC,CAAC,CAAC,CAAC;IAC5D;;IAEA;IACA;IACA,IAAI,CAAC8D,UAAU,CAAC,CAAC;IAEjB,OAAO,IAAI;EACf,CAAC;EAED;AACR;AACA;AACA;AACA;EACQrG,MAAM,EAAE,SAAAA,CAAUqJ,UAAU,EAAE;IAC1B,IAAI,CAAC,IAAI,CAAC/B,WAAW,EAAE;MACnB,OAAO,IAAI;IACf;IAEA,IAAI,CAACgC,YAAY,CAACD,UAAU,CAAC;IAC7B,IAAI,CAACtF,UAAU,CAAC,CAAC;IAEjB,IAAI1E,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACgG,OAAO,CAAC,KAAK,UAAU,EAAE;MACpD,IAAIzH,IAAI,CAACwC,QAAQ,CAAC,IAAI,CAACb,SAAS,CAAC,EAAE;QAC/B,IAAI,CAACA,SAAS,GAAG,IAAI,CAAC8G,WAAW,CAAC,IAAI,CAAC9G,SAAS,CAAC;MACrD;IACJ;IAEA,IAAI,CAACuI,kBAAkB,CAAC,CAAC;IACzB,IAAI,IAAI,CAACpI,eAAe,EAAE;MACtB,IAAI,CAACoF,UAAU,CAAC,CAAC;IACrB;IAEA,OAAO,IAAI;EACf,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQgD,kBAAkB,EAAE,SAAAA,CAAA,EAAY;IAC5B,IAAI,IAAI,CAACxJ,KAAK,CAACuG,OAAO,IAAI,IAAI,CAAChF,EAAE,KAAK,IAAI,CAACvB,KAAK,CAACuG,OAAO,CAAChF,EAAE,EAAE;MACzD,IAAI,CAACH,eAAe,GAAG,KAAK;IAChC,CAAC,MAAM;MACH;MACA;MACA,IAAI,CAACA,eAAe,GAAG,IAAI,CAACF,YAAY,KAAK,IAAI,CAACD,SAAS;MAE3D,IAAI,IAAI,CAACG,eAAe,EAAE;QACtB,IAAI,CAACF,YAAY,GAAG,IAAI,CAACD,SAAS;MACtC;IACJ;EACJ,CAAC;EAED;AACR;AACA;AACA;AACA;EACQuG,cAAc,EAAE,SAAAA,CAAA,EAAY;IACxB;IACI;IACAlI,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC0I,YAAY,CAAC,EAC1C;MACE,IAAI,CAACC,eAAe,CAAC,CAAC,CAACC,gBAAgB,CAAC,CAAC;IAC7C;IACA,OAAO,IAAI,CAACC,qBAAqB,CAAC,YAAY,CAAC;EACnD,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;EACQC,eAAe,EAAE,SAAAA,CAAUC,IAAI,EAAE;IAC7B,IAAIC,EAAE,GAAG,2BAA2B;IACpC,OAAOD,IAAI,CAACrE,OAAO,CAACsE,EAAE,EAAE,OAAO,CAAC;EACpC,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQC,YAAY,EAAE,SAAAA,CAAUC,UAAU,EAAEC,MAAM,EAAEC,eAAe,EAAE;IACzD,IAAIC,GAAG;MACHC,IAAI;MACJjG,CAAC;MACDoE,CAAC;MACDvH,SAAS,GAAG,IAAI;;IAEpB;IACAgJ,UAAU,GAAGA,UAAU,IAAI,EAAE;IAC7BA,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;IAC1CwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;IAC1CwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC;IAC1CwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;;IAE5C;IACA;IACA;IACA;IACAwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,YAAY,EAAE,OAAO,CAAC;IACtDwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,aAAa,EAAE,OAAO,CAAC;IACvDwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,mBAAmB,EAAE,OAAO,CAAC;IAC7DwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,oBAAoB,EAAE,SAAS,CAAC;IAEhEwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,gBAAgB,EAAE,SAAS,CAAC;IAC5DwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,kBAAkB,EAAE,UAAU,CAAC;;IAE/D;IACArB,CAAC,GAAG6F,UAAU,CAAC1B,OAAO,CAAC,SAAS,CAAC;IACjCC,CAAC,GAAGyB,UAAU,CAAC1B,OAAO,CAAC,UAAU,CAAC;IAClC,IAAInE,CAAC,IAAI,CAAC,EAAE;MACR,OAAOA,CAAC,IAAI,CAAC,EAAE;QACXnD,SAAS,IACL,MAAM,GAAG,IAAI,CAAC8D,UAAU,CAAC,IAAI,CAACC,UAAU,CAACiF,UAAU,CAAC9D,KAAK,CAAC,CAAC,EAAE/B,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;QAC3E;;QAEAiG,IAAI,GAAGJ,UAAU,CAAC9D,KAAK,CAAC/B,CAAC,GAAG,CAAC,EAAEoE,CAAC,CAAC;QACjC6B,IAAI,GAAGA,IAAI,CAAC5E,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC;QACjC,IAAIyE,MAAM,KAAK,IAAI,EAAE;UACjBG,IAAI,GAAG,IAAI,CAACR,eAAe,CAACQ,IAAI,CAAC;QACrC;QACA,IAAIF,eAAe,EAAE;UACjBC,GAAG,GAAGC,IAAI;QACd,CAAC,MAAM;UACHD,GAAG,GAAGhL,aAAa,CAACkL,UAAU,CAACD,IAAI,EAAE,IAAI,CAACrK,KAAK,CAAC;QACpD;QACAoK,GAAG,GAAGA,GAAG,CAAC3E,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;QAC9B2E,GAAG,GAAGA,GAAG,CAAC3E,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;;QAE9B;QACA,IAAI2E,GAAG,CAAC7B,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE;UAC5B;UACA,IACIjJ,IAAI,CAAC4F,QAAQ,CACT5F,IAAI,CAACiL,IAAI,CAAC,IAAI,CAACvK,KAAK,CAAC2F,EAAE,CAACC,OAAO,CAACwE,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC,CACjE,CAAC,EACH;YACE;YACAnJ,SAAS,IAAI,IAAI,GAAGmJ,GAAG,GAAG,YAAY,GAAG9K,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACmD,MAAM,CAAC,GAAG,GAAG;UACrF,CAAC,MAAM;YACHjD,SAAS,IAAI,IAAI,GAAGmJ,GAAG,GAAG,GAAG;UACjC;QACJ,CAAC,MAAM;UACHnJ,SAAS,IAAI,IAAI,GAAGmJ,GAAG,GAAG,GAAG;QACjC;QAEAH,UAAU,GAAGA,UAAU,CAAC9D,KAAK,CAACqC,CAAC,GAAG,CAAC,CAAC;QACpCpE,CAAC,GAAG6F,UAAU,CAAC1B,OAAO,CAAC,SAAS,CAAC;QACjCC,CAAC,GAAGyB,UAAU,CAAC1B,OAAO,CAAC,UAAU,CAAC;MACtC;IACJ;IAEAtH,SAAS,IAAI,MAAM,GAAG,IAAI,CAAC8D,UAAU,CAAC,IAAI,CAACC,UAAU,CAACiF,UAAU,CAAC,CAAC,GAAG,GAAG;IACxEhJ,SAAS,GAAG,IAAI,CAACgE,iCAAiC,CAAChE,SAAS,CAAC;;IAE7D;IACAA,SAAS,GAAGA,SAAS,CAACwE,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC;IAC5CxE,SAAS,GAAGA,SAAS,CAACwE,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC;IAExC,OAAOxE,SAAS;EACpB,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQsE,oBAAoB,EAAE,SAAAA,CAAU0E,UAAU,EAAE;IACxC,IAAIG,GAAG;MAAEC,IAAI;MACTjG,CAAC;MAAEoE,CAAC;MACJqB,eAAe,GAAG,IAAI;MACtBW,SAAS,GAAG,EAAE;MACdC,IAAI,GAAG,GAAG;IAEdR,UAAU,GAAGA,UAAU,IAAI,EAAE;IAC7BA,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;IAC1CwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;IAE1CwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,gBAAgB,EAAE,SAAS,CAAC;IAC5DwE,UAAU,GAAGA,UAAU,CAACxE,OAAO,CAAC,kBAAkB,EAAE,UAAU,CAAC;;IAE/D;IACArB,CAAC,GAAG6F,UAAU,CAAC1B,OAAO,CAAC,SAAS,CAAC;IACjCC,CAAC,GAAGyB,UAAU,CAAC1B,OAAO,CAAC,UAAU,CAAC;IAClC,IAAInE,CAAC,IAAI,CAAC,EAAE;MACR,OAAOA,CAAC,IAAI,CAAC,EAAE;QACX;QACAoG,SAAS,CAACE,IAAI,CAACD,IAAI,GAAG,IAAI,CAACE,WAAW,CAACV,UAAU,CAAC9D,KAAK,CAAC,CAAC,EAAE/B,CAAC,CAAC,CAAC,GAAGqG,IAAI,CAAC;QAEtEJ,IAAI,GAAGJ,UAAU,CAAC9D,KAAK,CAAC/B,CAAC,GAAG,CAAC,EAAEoE,CAAC,CAAC;QACjC6B,IAAI,GAAGA,IAAI,CAAC5E,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC;QACjC,IAAIoE,eAAe,KAAK,IAAI,EAAE;UAC1BQ,IAAI,GAAG,IAAI,CAACR,eAAe,CAACQ,IAAI,CAAC;QACrC;QACAD,GAAG,GAAGC,IAAI;QACVD,GAAG,GAAGA,GAAG,CAAC3E,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;;QAEnD;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACI+E,SAAS,CAACE,IAAI,CAAC,GAAG,GAAGN,GAAG,GAAG,GAAG,CAAC;QACnC;QACAH,UAAU,GAAGA,UAAU,CAAC9D,KAAK,CAACqC,CAAC,GAAG,CAAC,CAAC;QACpCpE,CAAC,GAAG6F,UAAU,CAAC1B,OAAO,CAAC,SAAS,CAAC;QACjCC,CAAC,GAAGyB,UAAU,CAAC1B,OAAO,CAAC,UAAU,CAAC;MACtC;IACJ;IACA;IACAiC,SAAS,CAACE,IAAI,CAACD,IAAI,GAAG,IAAI,CAACE,WAAW,CAACV,UAAU,CAAC,GAAGQ,IAAI,CAAC;;IAE1D;IACA,KAAKrG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGoG,SAAS,CAAClH,MAAM,EAAEc,CAAC,EAAE,EAAE;MACnCoG,SAAS,CAACpG,CAAC,CAAC,GAAGoG,SAAS,CAACpG,CAAC,CAAC,CAACqB,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC;IACtD;IACA,OAAO+E,SAAS;EACpB,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQ9E,WAAW,EAAE,SAAAA,CAAUgB,CAAC,EAAE;IACtB,IAAItC,CAAC,EAAEwG,CAAC;IACR,IAAItL,IAAI,CAACkG,OAAO,CAACkB,CAAC,CAAC,EAAE;MACjBkE,CAAC,GAAG,EAAE;MACN,KAAKxG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsC,CAAC,CAACpD,MAAM,EAAEc,CAAC,EAAE,EAAE;QAC3BwG,CAAC,CAACF,IAAI,CAAC,IAAI,CAAChF,WAAW,CAACgB,CAAC,CAACtC,CAAC,CAAC,CAAC,CAAC;MAClC;MACA,OAAOwG,CAAC;IACZ;IAEAlE,CAAC,GAAGA,CAAC,CACAjB,OAAO,CAAC,cAAc,EAAE,OAAO,CAAC,CAChCA,OAAO,CAAC,oBAAoB,EAAE,OAAO,CAAC,CACtCA,OAAO,CAAC,eAAe,EAAE,SAAS,CAAC,CACnCA,OAAO,CAAC,qBAAqB,EAAE,SAAS,CAAC;IAC9C,OAAO,IAAI,CAACR,iCAAiC,CAAC,IAAI,CAACF,UAAU,CAAC,IAAI,CAACC,UAAU,CAAC0B,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;EAC5F,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;EACQiE,WAAW,EAAE,SAAAA,CAAUjE,CAAC,EAAE;IACtB,OAAOA,CAAC,CAACjB,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;EACtD,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;EACQW,aAAa,EAAE,SAAAA,CAAUM,CAAC,EAAE;IACxB,OAAOA,CAAC,CAACjB,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;EACtD,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;EACQoF,kBAAkB,EAAE,SAAAA,CAAUnE,CAAC,EAAE;IAC7B,IAAIpH,IAAI,CAACwC,QAAQ,CAAC4E,CAAC,CAAC,EAAE;MAClBA,CAAC,GAAGA,CAAC,CAACjB,OAAO,CACT,2BAA2B,EAC3B,wCACJ,CAAC;MACDiB,CAAC,GAAGA,CAAC,CAACjB,OAAO,CAAC,6BAA6B,EAAE,SAAS,CAAC;MACvDiB,CAAC,GAAGA,CAAC,CAACjB,OAAO,CACT,wBAAwB,EACxB,wCACJ,CAAC;MACDiB,CAAC,GAAGA,CAAC,CAACjB,OAAO,CAAC,0BAA0B,EAAE,SAAS,CAAC;IACxD;IAEA,OAAOiB,CAAC;EACZ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQoE,uBAAuB,EAAE,SAAAA,CAAUpE,CAAC,EAAEqE,MAAM,EAAE;IAC1C,IAAIC,EAAE,GAAG,gDAAgD;MACrDC,EAAE,GAAG,YAAY;IAErB,IAAI3L,IAAI,CAACwC,QAAQ,CAAC4E,CAAC,CAAC,EAAE;MAClB,IAAIqE,MAAM,EAAE;QACRC,EAAE,GAAG,IAAI,CAACL,WAAW,CAACK,EAAE,CAAC;QACzBC,EAAE,GAAG,IAAI,CAACN,WAAW,CAACM,EAAE,CAAC;MAC7B;MACAvE,CAAC,GAAGA,CAAC,CAACjB,OAAO,CAAC,8BAA8B,EAAEuF,EAAE,CAAC;MACjDtE,CAAC,GAAGA,CAAC,CAACjB,OAAO,CAAC,gCAAgC,EAAEwF,EAAE,CAAC;IACvD;IAEA,OAAOvE,CAAC;EACZ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQzB,iCAAiC,EAAE,SAAAA,CAAUyB,CAAC,EAAEqE,MAAM,EAAE;IACpDrE,CAAC,GAAG,IAAI,CAACmE,kBAAkB,CAACnE,CAAC,CAAC;IAC9BA,CAAC,GAAG,IAAI,CAACoE,uBAAuB,CAACpE,CAAC,EAAEqE,MAAM,CAAC;IAC3C,OAAOrE,CAAC;EACZ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;EACQ3E,aAAa,EAAE,SAAAA,CAAU1B,OAAO,EAAE;IAC9B,IAAI6K,MAAM;MACNd,GAAG,GAAG,IAAI;;IAEd;IACA/J,OAAO,GAAGA,OAAO,CAACoF,OAAO,CAAC,gBAAgB,EAAE,SAAS,CAAC;IACtDpF,OAAO,GAAGA,OAAO,CAACoF,OAAO,CAAC,kBAAkB,EAAE,UAAU,CAAC;IAEzD,GAAG;MACCyF,MAAM,GAAG,2CAA2C;MACpDd,GAAG,GAAGc,MAAM,CAACC,IAAI,CAAC9K,OAAO,CAAC;MAE1B,IAAI+J,GAAG,KAAK,IAAI,EAAE;QACdhL,aAAa,CAACgM,gBAAgB,CAAC,IAAI,EAAEhB,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,CAACpK,KAAK,CAAC;QACxDK,OAAO,GAAGA,OAAO,CAAC8F,KAAK,CAACiE,GAAG,CAACiB,KAAK,CAAC;QAClChL,OAAO,GAAGA,OAAO,CAACoF,OAAO,CAACyF,MAAM,EAAE,EAAE,CAAC;MACzC;IACJ,CAAC,QAAQd,GAAG,KAAK,IAAI;IAErB,OAAO,IAAI;EACf,CAAC;EAED;EACAkB,UAAU,EAAE,SAAAA,CAAA,EAAY;IACpB,IAAIC,CAAC;IACL,IAAI,IAAI,CAACrC,cAAc,KAAKsC,SAAS,EAAE;MACnC;MACAD,CAAC,GAAG,CACA,IAAI,CAACrC,cAAc,CAACH,SAAS,CAAC,CAAC,CAAC,EAChC,IAAI,CAACG,cAAc,CAACH,SAAS,CAAC,CAAC,CAAC,EAChC,IAAI,CAAC5H,OAAO,CACf;IACL,CAAC,MAAM;MACH;MACAoK,CAAC,GAAG,CAAC,IAAI,CAACE,CAAC,CAAC,CAAC,EAAE,IAAI,CAACC,CAAC,CAAC,CAAC,EAAE,IAAI,CAACC,CAAC,CAAC,CAAC,EAAE,IAAI,CAACxK,OAAO,CAAC;IACpD;IAEA,IAAI,IAAI,CAACyK,OAAO,CAACtI,MAAM,KAAK,CAAC,EAAE;MAC3BiI,CAAC,GAAG,IAAI,CAACK,OAAO;IACpB;IAEA,OAAOL,CAAC;EACZ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQM,MAAM,EAAE,SAAAA,CAAA,EAAY;IAChB,IAAIC,CAAC,GAAG,IAAI,CAAC3L,MAAM,CAAC4I,SAAS;IAE7B,IACIzJ,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACC,OAAO,CAAC,IACnC,IAAI,CAAChB,KAAK,CAACiJ,KAAK,KAAK,CAAC,IACtB,IAAI,CAACjJ,KAAK,CAACgJ,KAAK,KAAK,CAAC,EACxB;MACE,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACvB;IACA,OAAO,CACH8C,CAAC,CAAC,CAAC,CAAC,EACJA,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAACxK,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAACtB,KAAK,CAACiJ,KAAK,EACtC6C,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAACxK,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAACtB,KAAK,CAACgJ,KAAK,EACtC8C,CAAC,CAAC,CAAC,CAAC,CACP;EACL,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;EACQpI,UAAU,EAAE,SAAAA,CAAA,EAAY;IACpB,IAAIkH,CAAC,GAAGtL,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACgL,OAAO,CAAC;IAC3C,IAAInB,CAAC,KAAK,MAAM,EAAE;MACd,QAAQ,IAAI,CAAC7J,OAAO,CAACiL,QAAQ;QACzB,KAAK,KAAK;QACV,KAAK,KAAK;UACN,OAAO,QAAQ;QACnB,KAAK,IAAI;QACT,KAAK,KAAK;QACV,KAAK,KAAK;UACN,OAAO,MAAM;QACjB,KAAK,KAAK;QACV,KAAK,MAAM;QACX,KAAK,MAAM;QACX;UACI,OAAO,OAAO;MACtB;IACJ;IACA,OAAOpB,CAAC;EACZ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;EACQhH,UAAU,EAAE,SAAAA,CAAA,EAAY;IACpB,IAAIgH,CAAC,GAAGtL,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACkL,OAAO,CAAC;IAC3C,IAAIrB,CAAC,KAAK,MAAM,EAAE;MACd,QAAQ,IAAI,CAAC7J,OAAO,CAACiL,QAAQ;QACzB,KAAK,KAAK;QACV,KAAK,MAAM;QACX,KAAK,KAAK;UACN,OAAO,QAAQ;QACnB,KAAK,KAAK;QACV,KAAK,KAAK;QACV,KAAK,MAAM;UACP,OAAO,KAAK;QAChB,KAAK,IAAI;QACT,KAAK,KAAK;QACV;UACI,OAAO,QAAQ;MACvB;IACJ;IACA,OAAOpB,CAAC;EACZ,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACQsB,oBAAoB,EAAE,SAAAA,CAAU3J,CAAC,EAAEC,CAAC,EAAE2J,CAAC,EAAEC,CAAC,EAAE;IACxC,IAAIC,KAAK,GAAG,CAAC;MACTjI,CAAC;MAAEkI,GAAG;MAAEC,EAAE;MACVC,kBAAkB;;IAEtB;IACAA,kBAAkB,GAAG,IAAI,CAACxM,KAAK,CAACoD,OAAO,CAACF,SAAS,CAACZ,QAAQ;IAC1D;IACA,IAAI,CAACtC,KAAK,CAACoD,OAAO,CAACF,SAAS,CAACZ,QAAQ,GAAG,CAAC6J,CAAC,GAAGC,CAAC,IAAI,IAAI;IACtD;IACA;IACA,KAAKhI,CAAC,GAAG,CAAC,EAAEmI,EAAE,GAAG,IAAI,CAACvM,KAAK,CAACyM,WAAW,CAACnJ,MAAM,EAAEc,CAAC,GAAGmI,EAAE,EAAEnI,CAAC,EAAE,EAAE;MACzDkI,GAAG,GAAG,IAAI,CAACtM,KAAK,CAACyM,WAAW,CAACrI,CAAC,CAAC;MAC/B,IACIkI,GAAG,CAACI,WAAW,CAAC9K,OAAO,IACvB0K,GAAG,CAACtK,MAAM,KAAK,MAAM,IACrBsK,GAAG,CAACtK,MAAM,KAAK,OAAO,IACtBsK,GAAG,KAAK,IAAI,CAACtM,KAAK,CAACuG,OAAO,IAC1B+F,GAAG,KAAK,IAAI,IACZA,GAAG,CAAChK,QAAQ,CAACC,CAAC,EAAEC,CAAC,CAAC,EACpB;QACE6J,KAAK,EAAE;MACX;IACJ;IACA,IAAI,CAACrM,KAAK,CAACoD,OAAO,CAACF,SAAS,CAACZ,QAAQ,GAAGkK,kBAAkB;IAE1D,OAAOH,KAAK;EAChB,CAAC;EAED;AACR;AACA;AACA;AACA;AACA;AACA;EACQ3C,eAAe,EAAE,SAAAA,CAAA,EAAY;IACzB,IAAInH,CAAC;MAAEC,CAAC;MAAEmK,EAAE;MAAEC,EAAE;MACZC,YAAY;MACZ;MACAV,CAAC,GAAG,IAAI,CAAC7K,IAAI,CAAC,CAAC,CAAC;MAChB8K,CAAC,GAAG,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC;MAChBwL,WAAW;MAAEC,KAAK;MAClBC,OAAO,GAAG;QACNC,SAAS,EAAEC,QAAQ;QACnBH,KAAK,EAAE,CAAC;QACR/J,CAAC,EAAE;MACP,CAAC;MACDmK,KAAK;MAAEC,OAAO;MACdH,SAAS;MAAEI,MAAM;MAAErK,CAAC;MACpBsK,aAAa,GAAG,EAAE;MAClBC,IAAI,GAAI,CAAC,GAAGC,IAAI,CAACC,EAAE,GAAIH,aAAa;MACpC9E,CAAC;MAAEI,EAAE;MAAEC,EAAE;MAAE6E,EAAE;MAAEC,EAAE;IAErB,IACI,IAAI,KAAK,IAAI,CAAC3N,KAAK,CAACuG,OAAO,IAC3B,CAAC,IAAI,CAACmG,WAAW,CAAC9K,OAAO,IACzB,CAACtC,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACC,OAAO,CAAC,IACpC,CAAC,IAAI,CAACN,OAAO,EACf;MACE,OAAO,IAAI;IACf;;IAEA;IACA;IACA2M,MAAM,GAAG/N,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAACsM,MAAM,CAAC;IAC3CR,YAAY,GAAG,IAAI,CAACnM,OAAO,CAACoI,cAAc,CAAC,CAAC;IAC5C6D,EAAE,GAAGE,YAAY,CAAClJ,SAAS,CAAC,CAAC,CAAC;IAC9BiJ,EAAE,GAAGC,YAAY,CAAClJ,SAAS,CAAC,CAAC,CAAC;;IAE9B;IACA;IACAiF,EAAE,GAAGyE,MAAM,CAAC,CAAC,CAAC;IACdxE,EAAE,GAAGwE,MAAM,CAAC,CAAC,CAAC;IAEdJ,SAAS,GAAG,IAAI,CAACf,oBAAoB,CAACS,EAAE,GAAG/D,EAAE,EAAEgE,EAAE,GAAG/D,EAAE,EAAEsD,CAAC,EAAEC,CAAC,CAAC;IAC7D,IAAIa,SAAS,KAAK,CAAC,EAAE;MACjB,OAAO,IAAI;IACf;IACA;IACA;;IAEAjK,CAAC,GAAG1D,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC6M,uBAAuB,CAAC;IACvDT,KAAK,GAAG7N,IAAI,CAACwB,QAAQ,CAAC,IAAI,CAACC,OAAO,CAAC8M,uBAAuB,CAAC;IAC3DT,OAAO,GAAG,GAAG,GAAGpK,CAAC;IAEjB8J,WAAW,GAAGU,IAAI,CAACM,KAAK,CAACjF,EAAE,EAAED,EAAE,CAAC;IAEhCoE,OAAO,CAACC,SAAS,GAAGA,SAAS;IAC7BD,OAAO,CAACD,KAAK,GAAGD,WAAW;IAC3BE,OAAO,CAAChK,CAAC,GAAGA,CAAC;IAEb,OAAOgK,OAAO,CAACC,SAAS,GAAG,CAAC,IAAIjK,CAAC,IAAImK,KAAK,EAAE;MACxC,KACI3E,CAAC,GAAG,CAAC,EAAEuE,KAAK,GAAGD,WAAW,GAAGS,IAAI,EACjC/E,CAAC,GAAG8E,aAAa,IAAIN,OAAO,CAACC,SAAS,GAAG,CAAC,EAC1CzE,CAAC,EAAE,EACL;QACEkF,EAAE,GAAGF,IAAI,CAACO,GAAG,CAAChB,KAAK,CAAC;QACpBY,EAAE,GAAGH,IAAI,CAACQ,GAAG,CAACjB,KAAK,CAAC;QAEpBxK,CAAC,GAAGoK,EAAE,GAAG3J,CAAC,GAAG0K,EAAE;QACflL,CAAC,GAAGoK,EAAE,GAAG5J,CAAC,GAAG2K,EAAE;QAEfV,SAAS,GAAG,IAAI,CAACf,oBAAoB,CAAC3J,CAAC,EAAEC,CAAC,EAAE2J,CAAC,EAAEC,CAAC,CAAC;QACjD,IAAIa,SAAS,GAAGD,OAAO,CAACC,SAAS,EAAE;UAC/BD,OAAO,CAACC,SAAS,GAAGA,SAAS;UAC7BD,OAAO,CAACD,KAAK,GAAGA,KAAK;UACrBC,OAAO,CAAChK,CAAC,GAAGA,CAAC;QACjB;QACA,IAAIgK,OAAO,CAACC,SAAS,KAAK,CAAC,EAAE;UACzB;QACJ;QACAF,KAAK,IAAIQ,IAAI;MACjB;MACAvK,CAAC,IAAIoK,OAAO;IAChB;IACA;IACApK,CAAC,GAAGgK,OAAO,CAAChK,CAAC;IACb0K,EAAE,GAAGF,IAAI,CAACO,GAAG,CAACf,OAAO,CAACD,KAAK,CAAC;IAC5BY,EAAE,GAAGH,IAAI,CAACQ,GAAG,CAAChB,OAAO,CAACD,KAAK,CAAC;IAC5B,IAAI,CAAChM,OAAO,CAACsM,MAAM,GAAG,CAACrK,CAAC,GAAG0K,EAAE,EAAE1K,CAAC,GAAG2K,EAAE,CAAC;IAEtC,IAAID,EAAE,GAAG,CAAC,GAAG,EAAE;MACX,IAAI,CAAC3M,OAAO,CAACgL,OAAO,GAAG,OAAO;IAClC,CAAC,MAAM,IAAI2B,EAAE,GAAG,GAAG,EAAE;MACjB,IAAI,CAAC3M,OAAO,CAACgL,OAAO,GAAG,MAAM;IACjC,CAAC,MAAM;MACH,IAAI,CAAChL,OAAO,CAACgL,OAAO,GAAG,QAAQ;IACnC;IAEA,OAAO,IAAI;EACf;AACJ,CACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA9M,GAAG,CAACgP,UAAU,GAAG,UAAUjO,KAAK,EAAE4L,OAAO,EAAExL,UAAU,EAAE;EACnD,IAAI4F,CAAC;IACDkI,IAAI,GAAG5O,IAAI,CAAC6O,cAAc,CAAC/N,UAAU,EAA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"},"metadata":{},"sourceType":"module","externalDependencies":[]}